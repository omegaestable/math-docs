%% Preprint, November 25th, 2015 by RAZR
%% Last modified: March 21st, 2018 by RAZR.

\documentclass[a4paper,12pt,twoside]{article}
\date{today}

\usepackage[english]{babel}
\usepackage{lmodern,fancyhdr,lastpage,nccfoots,caption}
\usepackage{hyperref}
\usepackage{setspace}
\hypersetup{
    pdfstartview={FitH},    % fits the width of the page to the window {FitH},{FitV}
    pdftitle={Imaginaries in pairs of algebraically closed fields},  % title
    pdfauthor={Ignacio Padilla},  % author
    pdfsubject={Model Theory},  % subject of the document
    pdfkeywords={},  % list of keywords
    pdfnewwindow=true,  % links in new window
    colorlinks=true,  % false: boxed links; true: colored links
    linkcolor=blue,  % color of internal links
    citecolor=red,  % color of links to bibliography
    urlcolor=blue  % color of external links
}

\usepackage[utf8]{inputenc}
\usepackage[all]{xy}
\usepackage{array}
\usepackage{graphicx,color}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{enumerate}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{textcomp}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{mathrsfs}
\usepackage{mathtools}


%%%%================= Useful macros: ===================%%%%

\def\forkindep{\mathrel{\raise0.2ex\hbox{\ooalign{\hidewidth$\vert$\hidewidth\cr\raise-0.9ex\hbox{$\smile$}}}}}

\DeclareMathOperator{\Cb}{Cb} 
\DeclareMathOperator{\Aut}{Aut} 
\DeclareMathOperator{\cb}{cb}  
\DeclareMathOperator{\tp}{tp}     %% space of homomorphisms
\DeclareMathOperator{\acl}{acl}       %% rank
\DeclareMathOperator{\dcl}{dcl}     %% symmetrization
\DeclareMathOperator{\eq}{eq}       %% (matrix) trace

\newcommand{\la}{\lambda}           %% short for \lambda
\newcommand{\Om}{\varOmega}         %% short for \varOmega
\newcommand{\sg}{\sigma}            %% short for \sigma
\addto\captionsenglish{%
\renewcommand{\abstractname}{Abstract}
\renewcommand{\refname}{References}
}
\newcommand{\LL}{\mathcal L}
\newcommand{\MM}{\mathcal M}
\newcommand{\UU}{\mathcal U}
\newcommand{\VV}{\mathcal V}
\newcommand{\N}{\mathbb N}
\newcommand{\R}{\mathbb R}
\newcommand{\Q}{\mathbb Q}
\newcommand{\NN}{\mathcal N}
%%%%%%%% Theorems and suchlike %%%%%%%%%%%%%%

\theoremstyle{plain}
\newtheorem{Th}{Theorem}[section]   %% Theorem 1.1
\newtheorem*{nonum-Th}{Theorem}     %% No-numbered Theorem
\newtheorem{Prop}[Th]{Proposition}  %% Proposition 1.2
\newtheorem{Lem}[Th]{Lemma}         %% Lemma 1.3
\newtheorem{Cor}[Th]{Corollary}  
\newtheorem{Fact}[Th]{Fact}  %% Corollary 1.4
\newtheorem*{nonCor}{Corollary}  %% No-numbered Corollary 

\theoremstyle{definition}
\newtheorem{Def}[Th]{Definition} 
\newtheorem*{nonDef}{Definition}%% Definition 1.5

\newtheorem{Remark}[Th]{Remark}
\newtheorem*{clearstyl}{ \ }

\numberwithin{equation}{section}

\newcommand*{\QEDA}{\hfill\ensuremath{\boxminus}} % End thm with no proof
\DeclareRobustCommand{\QEDA}{\ifmmode
  \else \leavevmode\unskip\penalty9999 \hbox{}\nobreak\hfill \fi
  \quad\hbox{\qedasymbol}}
\newcommand{\qedasymbol}{$\boxminus$} %% Non-proofs end with `\QEDA'

\newcommand{\hideqed}{\renewcommand{\qed}{}} %% to suppress `\qed'

%%%%%%%% This deflates (sub)section titles %%%%%%%%%%%%%%

\makeatletter
\renewcommand{\section}{\@startsection{section}{1}{\z@}%
                        {-3.5ex \@plus -1ex \@minus -.2ex}%
                        {2.3ex \@plus.2ex}%
                        {\normalfont\large\bfseries}}
\renewcommand{\subsection}{\@startsection{subsection}{2}{\z@}%
                        {-3.25ex \@plus -1ex \@minus -.2ex}%
                        {1.5ex \@plus .2ex}%
                        {\normalfont\normalsize\bfseries}}
\renewcommand{\subsubsection}{\@startsection{subsubsection}{3}{\z@}%
                        {-3.25ex \@plus -1ex \@minus -.2ex}%
                        {1.5ex \@plus .2ex}%
                        {\normalfont\normalsize\itshape}}
\renewcommand{\@dotsep}{200} %% suppress dots in Contents
\makeatother

%=====================================================================
%% ++++++++++++++++++++ Article begins here ++++++++++++++++++++++++++
%=====================================================================
\setstretch{1.40}
\begin{document}
\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------




\pagenumbering{gobble}
\begin{center}
    % You can adjust the size of the logo here.
    \includegraphics[scale=.5]{logo.png}

    

    \vspace*{\fill}

    \huge \MakeUppercase{Imaginaries in Pairs of Algebraically Closed Fields}

    \vspace{5mm}

    \Large Juan Ignacio \textsc{Padilla Barrientos}

    \vspace*{\fill}
    \vspace*{\fill}

    Supervisor: Zo√© CHATZIDAKIS % Put inside a tabular environment if needed.

    \vspace*{\fill}

    \large Master Logique et Fondements de l'Informatique

    Septembre 2021
    \vspace{15mm}
    \\
    \includegraphics[scale=.35]{enslogo.jpg}
    \vspace*{\fill}
    \vspace*{\fill}

\end{center}
\clearpage
\pagenumbering{arabic}

\vfill

\end{titlepage}
\thispagestyle{empty}

\section*{Abstract}
Consider the theory $T$ of algebraically closed fields of a given characteristic $p$, in the language $L = \{ 0,1,+,-, \cdot \}$. Extend $L$ to a language $L_P$ by adding a predicate $P$, which is interpreted in a model $M \models T$ as a proper elementary substructure. Since $T$ has elimination of quantifiers, these pairs can be axiomatized by expressing $P \models T$, and $\exists x \ \neg P(x)$, obtaining a theory $T_P$ of elementary pairs $P \prec M$. 
The main goal is to add sorts to the language $L_P$, in order to achieve \textit{weak elimination of imaginaries}. Keisler in [5] proved that $T_P$ is complete, and in [2], Buechler showed that $T_P$ is an $\omega$-stable theory, of Morley rank $\omega$. This work is largely based on [9], by Anand Pillay.\\

\tableofcontents
\newpage


\section{Preliminaries on Stability Theory}
\noindent Let $T$ be a complete theory over a language $L$. If $M\models T$, and $A \subseteq M$, we denote the space of $n$-types with parameters in $A$ by $S_n(A)$, and let $S(A) = \cup_{i < \omega} S_n(A)$.  Recall that a theory is $\kappa$-stable if for every $M \models T$ and every $A \subseteq M$, if $|A|\leq \kappa$, then $|S_1(A)| \leq \kappa$, and we say $T$ is stable if it is $\kappa$-stable for some cardinal $\kappa$. We will use an equivalent characterization of stability, given by the definability of types.
\Def Let $M \models T$, and $A,B$ subsets of $M$. A type $p(x) \in S_n(A)$ is \textit{definable} over $B$ if for any $L$-formula $\varphi(x,y)$ there is an $L(B)$-formula $\psi(y)$ such that for all $a \in A^{|y|}$, $\varphi(x,a) \in p$ if and only if $M \models \psi(a)$. The formula $\psi(y)$ will be written as $d_p(\varphi)(y)$, and the set of $d_p( \varphi)(y)$, with  $\varphi(x,y)$ ranging over the $L$-formulas is called a \textit{definition scheme} for $p$.

\noindent The following proposition is Corollary 8.3.2 from [13].

\Prop The theory $T$ is stable if and only if all types are definable. \vspace{0.5cm}


\noindent \emph{Throughout the rest of the section we assume $T$ is an arbitrary, complete, $\omega$-stable theory. We will work inside a saturated model $M$ of $T$, and types over $M$ shall be referred to as \textit{global types}. We proceed by stating some definitions and results on canonical bases and forking in this stable context.}

\Def Let $E(x_1,\dots,x_n,y_1,\dots,y_n)$ be an $L$-formula that defines an equivalence relation on $M^n$. By \textit{real elements}, we mean tuples in $M^n$, while the equivalence classes of real elements modulo $E$ will be called \textit{imaginary elements.}
\vspace{0.5cm}

\Def Let $X \subseteq M$ be a definable set. A tuple $c \subset M$ is called a \textit{canonical parameter} (or code) of $X$ if $c$ is fixed by exactly the same automorphisms of $M$ which fix $X$ setwise.
\noindent It is possible to extend $T$ to a new theory $T^{\eq}$ (in a new language $L^{\eq}$), in which every definable set has a code. Let $(E_i)_{i \in I}$, an enumeration of every $\varnothing$-definable equivalence relation over $n_i$-tuples. To define $L^{\eq}$, add to $L$ a new sort $S_i$ for each $i$, which is to be interpreted as  $M^{n_i}/E_i$. Consider the many-sorted structure $M^{\eq} = (M , M^{n_i}/E_i)_{i \in I}$, and define for every $i$ the natural projection $\pi_i : M^{n_i} \mapsto M^{n_i}/E_i$ that sends $a$ to $a/E_i$. The theory of $M^{\eq}$ will be denoted as $T^{\eq}$. By Corollary 8.4.6 from [13], $T^{\eq}$ has \textit{elimination of imaginaries:} every imaginary is interdefinable with a real tuple. There are also three related notions that will be used throughout this work.
\Def \begin{enumerate}[i)]
\item $T$ has \textit{elimination of finite imaginaries} if for every $n$, every finite set of $n$-tuples has a canonical parameter.
\item $T$ has \textit{weak elimination of imaginaries}, if for every imaginary $e$ there is a real tuple $d$ such that $e \in \dcl^{\eq}(c)$ and $d \in \acl^{\eq}(e)$.
\item $T$ has \textit{geometric elimination of imaginaries}, if for every imaginary $e$ there is a real tuple $d$ such that $e \in \acl^{\eq}(c)$ and $d \in \acl^{\eq}(e)$.

\end{enumerate}
\noindent We now proceed with a survey of forking in the\textbf{ $\omega$-stable context}. For a definable set $X \subseteq M$, we denote by $RM(X)$ its Morley rank, and $DM(X)$ its Morley degree. Recall that $\omega$-stable theories are \textit{totally transcendental}: every definable set has a Morley rank. This rank can also be defined for types: if $p \in S_n(A)$, then $RM(p)$ is the minimal Morley rank of a formula in $p$, and $DM(p)$ is the minimal Morley degree of a formula in $p$ having Morley rank $RM(p)$.

\Def \textbf{(Forking)} Suppose $A\subseteq B \subseteq M$, $p \in S_n(A)$, $q \in S_n(B)$, and $p \subseteq q$. If \linebreak $RM(p) = RM(q)$, then $q$ is a \textit{non-forking} extension of $p$ to $B$. Otherwise, if \linebreak $RM(p) < RM(q)$, we say that $q$ \textit{forks over} $A$. We say that $p \in S_n(A)$ is \textit{stationary} if for all $B\supseteq A$, there is a unique non-forking extension of $p$ to $B$, or equivalently if $DM(p) = 1$.

\noindent \textbf{Notation: } If $p \in S(A)$ and $C \subseteq A$, we denote the restriction of $p$ to $S(C)$ by $p \restriction C$. If $p$ is stationary and $A \subseteq B$, we denote the unique non-forking extension of $p$ to $S(B)$ by $p|B$.

\Def Let $A\subseteq M$ , $p \in S(A)$ a stationary type. A \textit{canonical base} of $p$, denoted $\Cb(p)$, is a tuple $e \subseteq M^{\eq}$ such that for every $\sigma \in \operatorname{Aut}(M)$, $\sigma(p) = p$ if and only if $\sigma(e) = e$ (this tuple is unique up to interdefinability). If $p$ is not stationary, consider the finite set $\mathcal P$ of nonforking extensions of $p$ to $M$, and define $\cb(p)$ as a code for the set $\{ \Cb(q) , q \in \mathcal P \}$; then any automorphism of $M$ fixes $\cb(p)$ if and only if it permutes $\mathcal P$ (see Fact 1.8 \textit{(i))}.\\ 

\noindent The following is a summary of the properties of canonical bases we will use, they can be found as Proposition 2.20 and Remarks 2.26 , 3.19 in Chapter 1 of [8].
\pagebreak
\Fact Let $A\subseteq M$ , $p \in S(A)$. Then
\begin{enumerate}[(i)]
\item (Conjugacy) The set of automorphisms of $M$ that fix $A$ pointwise acts transitively on $\mathcal P$.
\item $\cb(p) \subseteq \dcl^{\eq}(A)$.
\item For any $B \subseteq A$, $p$ does not fork over $B$ if and only if $\cb(p) \subseteq \acl^{\eq} (B)$.
\item If $p$ is stationary, for any $B \subseteq A$, $p$ does not fork over $B$ and $p \restriction B$ is stationary if and only if $\Cb(p) \subseteq \dcl^{\eq} (B)$.
\item If $p$ is stationary, and $(a_i , i < \omega)$ is a sequence such that for all $i$, $a_i$ realizes $p|A \cup \{a_j , j <i \}$, then $\Cb(p) \subseteq \dcl^{\eq}(a_0 \dots , a_n)$ for some $n$.
\end{enumerate}
\Lem  Let $e$ be an imaginary in $M$ and let $a$ be a finite tuple of reals such \linebreak that $e = f(a)$ for some $\varnothing$-definable function $f$. Then $e = \cb(\tp(a/e))$. Moreover, if  $e' = \Cb(\tp(a/\acl^{\eq}(e)))$, then $e' \in \acl^{\eq}(e)$ and $e \in \dcl^{\eq}(e')$.
\begin{proof}
Let $p = \tp(a/e)$ and $p' = \tp(a /\acl^{\eq} (e))$. To see why $e = \cb(\tp(a/e))$, consider the equivalence relation $E(x,y)$ given by $f(x) = f(y)$; then $e$ is a code for the class of $a$. Let $\mathcal{P}$ as in Definition 1.7. Since $\mathcal{P}$ is finite, and $e'$ is the canonical base of an element of $\mathcal{P}$, it follows that $e' \in \acl^{\eq}(e)$. Now, suppose $\sigma(e') = e'$ for some automorphism of $M^{\eq}$; then $\sigma p' = p'$, so both formulas $f(x) = e $ and $f(x) = \sigma(e)$ belong to $p'$, which implies $\sigma(e) = e$, hence $e \in \dcl^{\eq}(e')$.
\end{proof}

\Lem Let $e$ be an imaginary in $M$ and let $a$ be a finite tuple of reals such \linebreak that $e = f(a)$ for some $\varnothing$-definable function $f$. There is $a' \in M^{\eq}$ such that $e \in \dcl^{\eq}(a')$ and $\tp(a'/e)$ is stationary.
\begin{proof}
Let $p = \tp(a/e)$ and let $p_1,\dots,p_n$ be its non-forking extensions to $\acl^{\eq}(e)$. Let $a_1,\dots,a_n \in M$ be such that $a_i$ realizes $p_i|\{a_1,\dots,a_{i-1},a_{i+1},\dots,a_n \}$. Let $a'$ be a code of this set of realizations. Then as $a \in \acl^{\eq}(a')$, there is a formula $\varphi(x,a')$ isolating $\tp(a/a')$; hence $M \models \forall x \varphi(x,a') \rightarrow f(x) = e$, as $f$ is $\varnothing$-definable, so $e \in \dcl^{\eq}(a')$. Moreover, any automorphism of $M$ which fixes $e$ permutes $\{ p_1, \dots , p_n \}$, hence it fixes $\tp(a'/e)$.
\end{proof}

\Def \textbf{(Independence)} Let $A,B,C \subseteq M$. We say $A$ is \textit{independent} from $B$ over $C$, denoted
$$A \forkindep_C B,$$
if for every finite tuple $a$ from $A$, $\tp(a/BC)$ does not fork over $C$.

\noindent The following is a summary of the properties of the independence relation in the $\omega$-stable context. These are found as Theorem 8.5.5 from [13], and Lemmas 6.3.16 through 6.3.21 from [7].

\Fact  Let $A,B,C,D \subseteq M$. Forking independence has the following properties. 
\begin{enumerate}
\item (Monotonicity) If $A \forkindep_C B$ and $B' \subseteq B$, then $A \forkindep_C B'$.
\item (Transitivity) $A \forkindep_C BD$ if and only if $A \forkindep_C B$ and $A \forkindep_{C,B} D$.
\item (Existence) Every $p \in S(A)$ has a non-forking extension to any set containing $A$.
\item (Symmetry) If $A \forkindep_C B$, then $B \forkindep_C A$.
\item (Algebraic Closure) $A \forkindep_{C} \acl(A)$.
\end{enumerate}

\Def Let $A,B \subseteq M$ and  let $p \in S(A)$ be definable over $B$ by a scheme $d_p$. This definition scheme is called \textit{good} (over $B$) if the set
$$\{ \varphi(x,m) \mid \ M \models d_p(\varphi)(m) , \   m \in M, \ \varphi(x,y)  \ \text{an $L$-formula} \}$$
is a global type extending $p$.

\Lem Let $p \in S(A)$. Then $p$ is stationary if and only if it has a good definition over $A$.
\begin{proof}
If $p$ is stationary, let $q$ be its global non-forking extension. Then $q$ is definable and invariant under all automorphisms that fix $A$ setwise, hence it is definable over $A$. This gives a good definition for $p$. Conversely, assume $p$ has a good definition over $A$. There is then a global non-forking extension $p' \in \mathcal P$, definable over $A$. Since all elements of $\mathcal P$ are conjugate over $A$, and $p'$ is fixed by every automorphism which fixes $A$ setwise, it must be that $\{ p'\} = \mathcal P$. Therefore, $p$ is stationary.
\end{proof}

\Lem Let $a \in M$ be a tuple and $A \subseteq M$. Suppose $p = \tp(a/A)$ is stationary and let $a' \in M$ be a tuple such that $a' \in \dcl(Aa)$. Then $\tp(a'/A)$ is stationary.
\begin{proof}
We shall give a good definition scheme over $A$ for $\tp(a'/A)$. Let $\varphi(x,y)$ be an $L$-formula and $m \in M$ such that $M \models \varphi(a',m)$. By stationarity of $p$, there is an $L(A)$-formula $d_p(\varphi)(y)$ such that $\varphi(x,m) \in \tp(a/A)$ if and only if $M \models d_p(\varphi)(m)$. By hypothesis, there is an $A$-definable function $f$ such that $f(a)=a'$. Let $\tilde\varphi(x,y) = \varphi(f(x),y)$,
\begin{align*}
M \models \varphi(a',m) &\iff M \models \varphi(f(a),m) \\
&\iff M \models \tilde\varphi(a,m) \\
&\iff M \models d_p(\tilde\varphi)(m).
\end{align*} \end{proof}
\Def A  type $p(x) \in S(A)$ is said \textit{internal} to a partial type $\Sigma(y)$ if there are: a realization $a$ of $p$, and $B \supseteq A$ independent from $a$ over $A$, such that $a \in \dcl ( B  d)$ for some finite tuple $d$ of realizations of $\Sigma$. If it happens instead that $a \in \acl ( B d)$, then the type is said to be \textit{almost internal} to $\Sigma$.
\Lem  Suppose $\tp(a/A)$ is stationary and almost internal to a partial type $\Sigma$. Then there is an imaginary $a'$ such that: $\tp(a'/A)$ is stationary and internal to $\Sigma$, $a' \in \dcl^{\eq}(Aa)$, and $a \in \acl^{\eq}(a')$. Such an $a'$ can be taken to be a code for a finite set of realizations of $\tp(a/A)$.
\begin{proof} 
By hypothesis, there are $B \supseteq A$ independent of $a$ over $A$ and a tuple $d$ of realizations of $ \Sigma$ such that $a \in \acl(Bd)$. We can replace $B$ by some finite tuple $b$ such that $a \in \acl(Abd)$. Let $q = \tp(b,d/Aa)$ and $c=\cb(q)$. By Fact 1.8 \textit{(ii)}, $c \in \dcl^{\eq} (Aa)$. Note that $b \forkindep_{A} a$, hence $b \forkindep_A c$ and $\tp(c/A)$ is $\Sigma$-internal. By definition of $c$, $bd \forkindep_{Ac} Aa$, but $a \in \acl(Abd)$, hence $a \in \acl^{\eq}(Ac)$. 
%Now, let $\varphi(x,y,z)$ be an $L(A)$-formula such that for some $n<\omega$, $$M \models \varphi(a,b,d) \land \exists^{ n} x \  \varphi(x,b,d).$$ Then $\varphi(a,y,z) \in q'$, and since $\varphi(\sigma(a),y,z) \in \sigma(q')$, for any $\sigma \in \operatorname{Aut}(M/c)$. If $b''d''$ realize $\sigma(q')$, then
%$$M \models \varphi(\sigma(a),b'',d'') \land \exists^{ n} x \  \varphi(x,b'',d''),$$
%hence $a$ must have finitely many conjugates over $Ac$.
%Moreover, $a \in \acl^{\eq}(A,c)$: take any automorphism $\sigma$ of $M$ which fixes $A \cup \{ c\} $ as a set, so that $q$ is $\sigma$-invariant. Let $\varphi(x,y,z)$ be some $L(A)$-formula such that $\varphi(x,y,a) \in q$ and such that there are only finitely many realizations of $\varphi(b,d,z)$.
%By invariance of $q$ over $c$, for any $\sigma \in \operatorname{Aut}(M^{\eq}/Ac)$,  $\varphi(\sigma(a),y,z)\in q$, therefore $a$ has finitely many conjugates over $Ac$, say $\{a_1,\dots,a_n\}$  
If $a'$ denotes the code for the finite set of conjugates of $a$ over
$Ac$, then $$a'\in \dcl^{\eq}(Ac)\subseteq \dcl^{\eq}(Aa).$$ Because $\tp(c/A)$ is
internal to $\Sigma$, so is $\tp(a'/A)$. Moreover, $\tp(a'/A)$ is stationary by Lemma 1.15. We may note that $c \in \acl(Aa')$ as well: if $a''$ is any conjugate of $a$ over $Ac$, then it realizes the same type over $Ac$ as $a$.
\end{proof}

\Lem Let $\Sigma$ be a partial type, and let $p \in S(A)$ be a stationary, $\Sigma$-internal type. There exists a partial $A$-definable function $h(y_1,\dots,y_m,z_1,\dots,z_n)$ and a sequence $b_1,\dots,b_m$ of realizations of $p$, such that for any realization $a$ of $p$, there is a sequence $c_1,\dots,c_n$ of realizations of $\Sigma$, such that $a = h(b_1,\dots,b_m,c_1,\dots,c_n)$.

\begin{proof} 
Let $b$ realize $p$, $B \supseteq A$ independent from $b$ over $A$, and $d$ a tuple of realizations of $\Sigma$ such that $b \in \dcl(Bd)$. 

\noindent \textbf{Claim:} For any $b'$ realizing $p|Ab$, there is a sequence $d'$ of realizations of $\Sigma$ such that $b' = g(b,d')$, for some definable function $g$. \\
\noindent  Let $(b_i,d_i)_{i<\omega}$ be a Morley sequence of $\tp(b,d/\acl^{\eq}(B))$. By Fact 1.8 \textit{(v)}, $\tp(b,d/M)$ is definable over $A \cup \{ b_i,d_i, i < \omega \}$. In particular, for $m$ large enough, $$b \in \dcl(b_1,\dots,b_m,d_1,\dots,d_m,d,A),$$ such that  $\overline{d} = (d_1,\dots,d_m,d)$ , $\overline{b} = (b_1,\dots,b_m)$ are independent from $b$ over $A$. Then $b = g(\overline{b},\overline{d})$ for some $A$-definable function $g$. $_\blacksquare$

 \noindent Now let $a$ be an arbitrary realization of $p$, and let $\bar{a} = (a_1,\dots,a_m)$ realize $\tp(\overline{b}/\acl(A))$ such that $(a_1,\dots,a_m) \forkindep_A a\overline{b}$. By the claim, for each $i \leq m$ there is $\overline{c_i}$, a tuple of realizations of $\Sigma$, such that $a_i = g(\overline{b},\overline{c}_i)$. Since $\tp(a,\overline{a}/A) = \tp(b,\overline{b}/A)$,
 %there is an automorphism $\sigma$ of $M$ that fixes $A$ pointwise and sends $a$ to $b$, and $\overline{a}$ to $\overline{b}$. Since $b = g(\overline{b},\overline{d})$, we get
%$$a = g(\overline{a},\sigma(\overline{d}))=g(g(\overline{a},\overline{s}_1),\dots, g(\overline{a},\overline{s}_m),\sigma(\overline{d})).$$
%Notice that $\sigma(\bar{d})$ is also a tuple of realizations of $\Sigma$, hence by letting $(c_1,\dots,c_n) = (\bar{s_1},\dots,\bar{s_m},\sigma(\bar{d}))$
we also we get that $a = g(\overline{a},\overline{c})$ for some tuple $\overline{c}$ of realizations of $\Sigma$. It follows that $a= h(\overline{b},\overline{c},\overline{c}_1,\dots,\overline{c}_m)$ for an $A$-definable function $h$. 
\end{proof}
\noindent \emph{The following is Lemma 7.2.12 from [13], which holds for all simple theories.}
\Fact For all $A \subseteq M$ there is some $\lambda$ such that for any sequence $(a_i , i < \lambda )$ there exists an $A$-indiscernible sequence $(b_j , j < \omega)$ such that for all $j_1< \dots < j_n < \omega$ there is a sequence $i_1 < \dots < i_n < \lambda$ with $\tp(a_{i_1},\dots,a_{i_n}/A) = \tp (b_{j_i},\dots,b_{j_n}/A)$. 

%Let $\tau = \sup_{n < \omega} |S_n(A)|$, and let $\lambda = \beth_{\tau^+}$. Construct a sequence of types \linebreak $p_1(x_1) \subseteq p_2(x_1,x_2) \subseteq \dots$, with $p_n(x_1,\dots,x_n) \in S_n(A)$ for all $n < \omega$, such that for all $\kappa < \lambda$ there is some $ I \subseteq  \lambda$ of size $\kappa$ such that $\tp(a_{i_1},\dots, a_{i_n}) = p_n$ for al $i_1 < \dots < i_n $ from $I$, then just let $(b_i)_{i < \omega}$ as a realization of $\cup_{i < \omega} p_i$.


\Lem If $b \in \acl(aA)$ , then $RM(ab/A) = RM(a/A)$.
\begin{proof}
It is clear that $RM(ab/A) \geq RM(a/A)$, since the latter type contains less formulas. The reverse inequality is proved by induction on  $ \alpha = RM(a/A)$. Let $d = DM(ab/Aa)$ be its Morley degree. Choose an $L(A)$-formula $\varphi(x,y) \in \tp(ab/A)$ such that $RM( \exists y \varphi(x,y)) =  \alpha$ and $\varphi(a',y)$ has at most $d$ realizations for all $a'$. If $Y$ is the set defined by $\exists x \varphi(x,y)$, we claim that $RM(Y) \leq \alpha$. Consider an infinite famility of pairwise disjoint definable subsets $Y_i \subseteq Y$. Let $\psi_i(x) = \exists y ( \varphi(x,y) \land y \in Y_i)$. Note that any $d+1$ of the $\psi_i(M)$ have empty intersection: if $M \models \bigwedge_{i=0}^d \psi_i(a')$, then there exist $b_i \in Y_i$ for $0 \leq i \leq d$ such that $\models \varphi(a',b_i)$, which contradicts our choice of $\varphi$. Therefore, some $\psi_i(x)$ has Morley rank $\beta < \alpha$. Let $b' \in Y_i$, and choose $a'$ such that $M \models \varphi(a',b')$. Then $b'$ is algebraic over $a'A$ and since $a'$ realizes $\psi_i(x)$, we have $RM(a'/A) \leq \beta$. So by induction hypothesis, we conclude $RM(a'b'/A) \leq \beta$, which shows $RM (Y_i) \leq \beta$. This implies that $Y$ does not contain an infinite famility of disjoint subsets of Morley rank $\geq \alpha$.
\end{proof}

\noindent \emph{The following definition comes from  10.2.8 of [13]}.

\Def  Let $A,B \subseteq M$ be definable sets and let $f : B\to A$ be a definable function. The fibers of $f$ have definable Morley rank if for every definable $B' \subseteq B$ and every $k< \omega$, the set $\{ a \in A , \ RM(f^{-1}(a) \cap B') = k  \}$ is definable.

\Lem Let $A,B \subseteq M$ be definable sets and let $f : B\to A$ be a definable surjection whose fibers have definable Morley rank, and such that for all $a \in A$ , $RM(f^{-1}(a))=k$. Then $RM(B) = RM(A)+k$.

\begin{proof}
Suppose $A,B,f$ are definable over some $S \subseteq M$. The proof is by induction on $RM(A)=m$, for all $k$. We may also asume that $DM(A)=1$: if not, then partition $A = A_1 \cup \dots \cup A_d$ into finitely many disjoint, rank $m$ definable subsets, then replace $B,A$ by $f^{-1}(A_1),A_1$, respectively. If $m = 0$, then $A$ is finite and 
$$RM(B) = \max \{ RM(f^{-1}(a)) \}_{a \in A } = k.$$
If $m > 0$, then write $A = \cup_i A_i$ for an infinite, pairwise disjoint family of definable $A_i \subseteq A$ such that $RM(A_i)=m-1$. If $B_i = f^{-1}(A_i)$, then $f\restriction B_i$ is a definable surjection with rank $k$ fibers, so by induction hypothesis $RM(B_i)=RM(A_i)+k=$ $m+k-1$, and since the $B_i$ are also pairwise disjoint, we deduce $RM(B) \geq m+k$. For the reverse inequality, let now $(B'_i)_{i < \omega}$ be any infinite, pairwise disjoint family of definable subsets $B'_i \subseteq B$; we will show that $RM(B'_i) < m+k$ for some $i$, by induction over $k$. If $k = 0$, $f$ is finite-to-one, so for any $b \in B$, $b \in \acl(f(b))$ and $f(b) \in \dcl(b)$. By Lemma 1.20, 
$$ RM(b/S) = RM(f(b),b/S) = RM(f(b)/S) \leq RM(A) =  m.$$
This implies $RM(B) = \sup_{b \in B}( RM(b/S))  \leq m$ .
Suppose now the conclusion holds for $m$ and for every $k'<k$. Let $a \in A$, then since $RM(f^{-1}(a)) = k$ and $f^{-1}(a) \supseteq \bigcup_i (f^{-1}(a) \cap B'_i) $, it must be that for some $j$, $RM((f^{-1}(a) \cap B'_j) < k$. Consider now the definable sets 
$$A'_i = \{a \in A , \ RM(f^{-1}(a)\cap B'_i ) = k\}.$$ 
We have proved that $\cap_i A'_i = \varnothing$. We claim that for some $i$, $RM(A'_i)< m$: if not, then as $DM(A) = 1$, for every $N$, $\cap_{i\leq N} A'_i \neq \varnothing$, hence by compactness $\cap_i A'_i \neq \varnothing$, a contradiction, since the Morley degree of the fibers is bounded.  Now, as $$B'_i=(f^{-1}(A'_i)\cap B'_i) \cup (f^{-1}(A\setminus A'_i)\cap B'_i),$$ we can apply induction hypothesis over $m$ to the first term to see that $RM(f^{-1}(A'_i)\cap B'_i) < m+k$. On the other hand, on $A\setminus A'_i$, all fibers have rank strictly less than $k$. The induction hypothesis over $k$ yields $RM(f^{-1}(A\setminus A'_i)\cap B'_i) < m+k$, concluding the proof.
%If $m > 0$, we now apply induction over $k$: if $k = 0$, we want to prove $MR(B) = m$, so let $a \in A$ such that $MR(\tp(a/A)) = MR(A)$. Let  $b \in f^{-1}(a)$, this implies $a \in \dcl(bM)$, hence by Lemma 1.9,
%$$m=RM(\tp(a/M)) \leq RM(\tp(b/M)) \leq RM(B).$$
%To see the other inequality, consider now $b \in B$ such that $RM(b/M) = RM(B)$, and let $a = f(b)$. Since $f^{-1}(a)$ is finite, $b \in \acl(aM)$, and by Lemma 1.9
%$$m \geq RM(\tp(a/M)) \geq RM(\tp(b/M)) = RM(B).$$
%Consider now the general case $m,k>0$.
\end{proof}

\Lem Let $P \subseteq M$ be a strongly minimal definable set, and $\varphi(x_1,\dots,x_n,\bar{y}) $ a formula such that $M \models \forall x_1,\dots,x_n ( \exists \bar{y} \  \varphi(x_1,\dots,x_n,\bar{y}) \rightarrow x_i \in P)$. The following set is definable for every $k$, $$Y_{n,k} = \{ \bar{b} \in M , RM \varphi(x_1,\dots,x_n,\bar{b}) = k \}.$$
\begin{proof}
Let $Y'_{n,k} =  \{ \bar{b} \in M , RM \varphi(x_1,\dots,x_n,\bar{b}) \geq k \}$. We will prove definability of $Y'_{n,k}$, this gives the desired result since $Y_{n,k} = Y'_{n,k} \setminus Y'_{n,k+1}$.
We proceed by induction on $n$. Notice that $Y'_{1,1}$ is definable since $RM(\varphi(x_1,\bar{b}))\geq 1$ if and only if $\exists^{\infty}x_1 \varphi(x_1,\bar{b})$, which is in turn equivalent (by strong minimality of $P$) to $\exists^{\geq N}x_1 \varphi(x_1,\bar{b})$, for some $N$. Moreover, notice that $$Y_{n,0} = \{ \bar{b} \in M , \exists x_1, \dots, x_n \varphi(x_1,\dots,x_n,\bar{b}) \}$$ is definable for all $n$. Let now $n>0$, we will work by induction over $k>0$. For $\bar{b} \in P$, consider the $\bar{b}$-formula $\phi_{\bar{b}}(x_0,\dots,x_{n-1})$ given by $ \exists x_n \varphi(x_0,\dots,x_{n-1},x_n,\bar{b})$. If \linebreak $RM(\phi_{\bar{b}}) \geq k$, then $\bar{b} \in Y'_{n,k}$, and if $RM(\phi_{\bar{b}})  < k$, consider instead the $L(\bar{b})$-formula $\psi_{\bar{b}}(x_0,\dots,x_{n-1})$ given by $ \exists^{\infty} x_n \varphi(x_0,\dots,x_{n-1},x_n,\bar{b})$, then since the algebraic dimension of a tuple inside $P$ agrees with its Morley rank, we have in this case that $RM(\psi_{\bar{b}}) \geq k-1$ if and only if $\bar{b} \in Y'_{n,k}$. We have shown that $\bar{b} \in Y'_{n,k}$ if and only if $RM(\phi_{\bar{b}}) \geq k$ or  $RM(\psi_{\bar{b}}) \geq k-1$. The first of these two conditions is definable by our induction hypothesis over $n$, while the latter is definable by induction over $k$, so $Y'_{n,k}$ is also definable. 
\end{proof}
\newpage
\section{Stable Groups}
\emph{ An $\omega$-stable group is an $\omega$-stable structure $(G,\cdot,1,\dots)$, where $(G,\cdot,1)$ is a group. In this section we present some basic concepts and tools used in the study of $\omega$-stable groups. For more details, see [11] and Chapter 7 from [7]. Throughout this section $G$ will denote an infinite, $\omega$-stable group, definable inside a saturated model $M$ of a complete, $\omega$-stable theory $T$.}
\Lem There is no infinite  strictly descending chain of definable subgroups $G > G_1 > G_2 > \dots$
\begin{proof}
For any definable subgroup $H \leq G$, and any $a \in G \setminus H$, the coset $aH \subseteq G$ is disjoint from $H$, and since $x \mapsto ax$ is a definable bijection, then $RM(H) = RM(aH)$. If $G > G_1 > G_2 > \dots$ is a strictly decreasing sequence, and if $[G_i : G_{i+1}]$ is infinite, then $RM(G_i) > RM(G_{i+1})$. If $[G_i : G_{i+1}]$ is finite, then  $DM(G_i) > DM(G_{i+1})$, and this implies the existence of a strictly decreasing sequence with respect to the lexicographic order $RM(G) \times \omega$, hence, this sequence cannot be infinite.
\end{proof}
\Lem There is a definable normal subgroup $G^0 \leq G$ that is contained in every subgroup of $G$ of finite index. 
\begin{proof}
Let $\mathcal H$ be the family of definable subgroups of $G$ of finite index. We claim that there are $H_1,\dots,H_n$ in $\mathcal H$ such that
$$\bigcap_{H\in \mathcal H}H = H_1 \cap  \dots \cap H_n.$$
If not, then for every $m$ there are $j_0,\dots,j_m$ such that if $G_m = H_{j_0}\cap \dots \cap H_{j_m}$, then $G_0 > G_1 > G_2 > ...$, contradicting Lemma 2.1. We may then define $G^0 =  H_1 \cap  \dots \cap H_n$. If $h \in G$, since $x \mapsto hxh^{-1}$ is a group automorphism, we have that $hG^0h^{-1}$ is a definable subgroup with $[G:hG^0h^{-1}] = [G:G^0]$, so $hG^0h^{-1}=G^0$ by minimality.
\end{proof}
\Lem Let $A\subseteq M$. If $G$ is $A$-definable, then $G^0$ is $A$-definable.
\begin{proof}
By Lemma 2.2, there are an $L(A)$-formula $\varphi(x,y)$ and $g \in G$ such that the formula $\varphi(x,g)$ defines $G^0$. Let $n = [G:G^0]$, and consider $$W = \{ b \in G , \ \varphi(x, b) \text{ defines a subgroup of index $n$ }\},$$ an $A$-definable set. If $b \in W$ and $H =\varphi(G,b)$, then $H\cap G^0$ is a finite index subgroup of $G^0$, hence $H \supseteq  G^0$. However, since $[G:H]=n$, we have $[H:G^0]=1$, yielding $H= G^0$. We can then define $G^0$ as $\{ g \in G , \exists b \ ( b  \in W \land  \varphi(g,b))\}$.
\end{proof}
\Def $G$ is \textit{connected} if $G=G^0$.



\Def There is an action of $G$ on $S_1(G)$ given by $g \cdot p = \{ \varphi(x) , \ \varphi(gx) \in p\}.$ The \textit{stabilizer} of $p$ is the group
$$\operatorname{Stab}(p) = \{g \in G , g \cdot p = p \}.$$

\Lem  $\operatorname{Stab}(p)$ is a definable subgroup of $G$, for every $p \in S_1(G)$.
\begin{proof}
For $\varphi(x,y)$ an $L$-formula, let $$\operatorname{Stab}_\varphi(p) = \{ g \in G \mid p_\varphi = g \cdot p_\varphi\},$$
where $$p_\varphi = \{ \varphi(x,g) \mid g \in G , \varphi(x,g) \in p\} \cup  \{ \neg \varphi(x,g) \mid g \in G , \varphi(x,g) \not \in p\} .$$
%We first show that $\operatorname{Stab}_\varphi(p)$ is a definable subgroup of $G$ for every $\varphi$. Let $g_1,g_2 \in \operatorname{Stab}_\varphi(p)$ and $h \in G$, then
%$$\varphi(hx) \in p \iff \varphi(hg_1x) \in p \iff \varphi(hg_1g_2x) \in p.$$
%Hence, $g_1g_2 \in \operatorname{Stab}_\varphi(p)$. Moreover,
%$$\varphi(hg_1^{-1}x) \in p \iff \varphi(hg_1g_1^{-1}x) \in p \iff \varphi(hx) \in p.$$
An easy calculation shows that for every $\varphi$, $\operatorname{Stab}_\varphi(p) \leq G$. By stability, there is a definition scheme for $p$, say $d_p$. Thus, 
$$\operatorname{Stab}_\varphi(p) = \{g \in G | \ \forall h (d_p(\varphi)(h) \leftrightarrow d_p(\varphi)(hg))  \}.$$
Note that
$\operatorname{Stab}(p) = \bigcap_{\varphi(x,y) \in L} \operatorname{Stab}_\varphi(p).$
%Suppose $g \in\operatorname{Stab}(p)$, $\varphi(x) \in p$ and $h \in G$. If $\psi(x)$ is the $L(G)$-formula given by $\varphi(hx)$, then as $g$ stabilizes $p$,
%$$\varphi(hx) \in p \iff \psi(x) \in p \iff \psi(gx) \in p \iff \varphi(ghx) \in p,$$
%hence $g \in \operatorname{Stab}_\varphi(p)$. If $g \in \operatorname{Stab}_{\varphi}(p)$ for every $\varphi \in p$, then clearly $g \in \operatorname{Stab}(p)$. 
By Lemma 2.1, there are $\varphi_1,\dots,\varphi_n \in L$ such that $\operatorname{Stab}(p) = \operatorname{Stab}_{\varphi_1}(p)\cap \dots \cap \operatorname{Stab}{\varphi_n}(p)$, which concludes the proof.
\end{proof}

\Lem Let $p \in S_1(G)$.
\begin{enumerate}[(i)]
\item $RM(\operatorname{Stab}(p)) \leq RM(p)$.
\item $\operatorname{Stab}(p) \leq G^{0}$.
\end{enumerate}
\begin{proof}
Let $a,b \in M$ be  such that $a$ realizes $p$, $b\in \operatorname{Stab}(p)$ satisfies  $RM(\tp(b/G)) =$ $RM(\operatorname{Stab}(p))$, and $a \forkindep_G b$. Then 
$$RM(\tp(ba/G,a)) = RM(\tp(b/G,a))= RM(\tp(b/G))=RM(\operatorname{Stab}(p)).$$
Moreover, since $ba$ realizes $p$, we have $RM(\tp(ba/G,a)) \leq RM(\tp(ba/G)) = RM(p)$, proving \textit{(i)}. Let now $c \in \operatorname{Stab}(p)$, and let $\varphi(x)$ define $G^0$(possibly with parameters in $M$). Let $g \in G$ be such that $\varphi(g^{-1} x) \in p$, thus $\varphi(g^{-1} c  x) \in p$. Let $G\preceq H$ and $ h \in H$ realize $p$. Then $g^{-1}ch \in H^0$ and $g^{-1} h \in H^0$. Thus $(g^{-1}h)^{-1}g^{-1} ch=h^{-1}ch \in H^0$, and since $H^0$ is normal, $c \in G^0$ by Lemma 2.3.
\end{proof}

\Def A type $p \in S_1(G)$ is \textit{generic} if $RM(p) = RM(G)$. An element $a \in G(M)$ is generic over $A \subseteq G$ if $RM(\tp(a/A)) = RM(G)$.

%\Remark If $\tp(x/G)$ is generic and $a \in G$, then $\tp(ax/G)$ and $\tp(x^{-1}/G)$ are generic.
%\begin{proof}
%Notice that if $b$ realizes $\tp(x/G)$, then by hypothesis of genericity $b \not\in G$. The maps $a \mapsto ax$ and $x \mapsto x^{-1}$ are definable bijections, hence preserve Morley rank.
%\end{proof}

\Lem A type $p \in S_1(G)$ is generic if and only if $[G:\operatorname{Stab}(p)]$ is finite.
\begin{proof}
Suppose $p$ is generic. Notice that $\{ ap , \ a \in G\}$ is finite, since there are only finitely many types of maximal Morley rank. Choose $b_1,\dots,b_n \in G$ such that if $a \in G$, then $ap = b_ip$ for some $i \leq n$. If $ap = b_ip$ then $b_i^{-1}a \in \operatorname{Stab}(p)$ and $a \in b_i \operatorname{Stab}(p)$. Therefore,  $[G:\operatorname{Stab}(p)] \leq n $. Assume now that $\operatorname{Stab}(p)$ has finite index, so $RM(G) = RM(\operatorname{Stab}(p))$, but $RM(\operatorname{Stab}(p)) \leq RM(p)$ by Lemma 2.7, hence $p$ is generic.
\end{proof}
\Cor \
\begin{enumerate}[(i)]

\item A type $p \in S_1(G)$ is generic if and only if $\operatorname{Stab}(p)= G^0$
\item $G$ has an unique generic type if and only if $G$ is connected.
\end{enumerate}

\begin{proof} \ 

\begin{enumerate}[(i)]
\item By Lemma 2.9, if $p$ is generic, $\operatorname{Stab}(p)$ has finite index, we have $G^0 \leq  \operatorname{Stab}(p)$. By Lemma 2.7 \textit{(ii)}, we have $G^0 \geq  \operatorname{Stab}(p)$. The other direction is clear by Lemma 2.9, since $G^0$ has finite index.
\item Let $p$ be the unique generic type. For all $a \in G$, $ap$ is generic, hence $ap = p$. Thus, $G = \operatorname{Stab}(p)=G^0$ by \textit{(i)}. Conversely, suppose $G=G^0$, and by contradiction, assume $p,q$ are distinct, generic types. Let $a,b$ realize $p,q$ respectively, with \linebreak $b \in H \succeq G$ and let $a'$ realize $p|H$. Then, $\tp(a,b/G)=\tp(a',b/G)$, and $p|H$ is a generic of $H$. By \textit{(i)}, $\operatorname{Stab}(p|H)=H^0=H$. Thus, $ba'$ realizes $p| H$. In particular, $ba'$ realizes $p$, hence $ba$ realizes $p$. If $a \in K \succeq G$, and $b'$ realizes $q|K$, an analogous argument shows  that $ba$ realizes $q$. This contradicts our assumption, hence $G$ has a unique generic type.
\end{enumerate}
\end{proof}
\section{Pairs of Algebraically Closed Fields}
\emph{Throughout this section, we will let $T=ACF_p$ for $p$ prime or $0$ (in the usual language $L$), and we consider $L_P$, the language obtained by adjoining a unary predicate $P$. An elementary pair of models of $T$, $N \preceq M$, is considered an $L_P$-structure by interpreting $P$ as the universe of the structure $N$, and $L_P$-structures will be naturally denoted as pairs $(M,P)$.}

\Def A \textit{beautiful pair} of models of $T$ is an elementary pair $N \preceq M$ such that $N$ is $|T|^+$-saturated and $M$ is $|T|^+$-saturated over $N$, which means that $M$ realizes any $L$-type over $N \cup A$, where $A \subseteq M \setminus N$ is such that $|A| < |T|^+$. The theory $T_P$ of proper pairs $P \prec M$ of models of $T$ was shown to be complete by Keisler in [5].
\Fact ([12]) Let $(M,P)$ be a saturated model of $T_P$.
\begin{enumerate}[(i)]
\item $(M,P)$ is a beautiful pair.
\item $T_P$ is stable.
\item Any  $L_P$-formula $\phi(x)$ is equivalent modulo $T_P$ to a Boolean combination of $L_P$-formulas of the form $\exists y P(y) \land \psi(y,x)$ where $\psi$ is a quantifier-free $L_P$-formula.
\end{enumerate}
\emph{Buechler in [2] notes that $T_P$ is actually $\omega$-stable of Morley rank $\omega$. From now on $(M,P)$ will be a saturated model of $T_P$.} \\
\noindent \emph{\textbf{Notation: } If $A\subseteq M$, we denote the field generated by $A$ by $\langle A \rangle$.  For any $A,B,C \subseteq M$, we denote independence in the sense of $L$ by $A \forkindep^L_C B$, and in the sense of $L_P$ by $A \forkindep^{L_P}_C B$. We will also distinguish $L$-types from $L_P$-types by using $\tp_L$ and $\tp_{L_P}$ respectively. We adopt the same convention for the $\acl$ and $\dcl$ operators.}

\Lem Any $C \subset P^n$ that is $L_P$-definable with parameters from $M$, is $L$-definable with parameters from $P$. In particular, $P$ is strongly minimal and stably embedded (in the $L_P$-sense). 
\begin{proof}
Let $\varphi(x,m)$ with $m \in M$ be an $L_P$-formula defining $C$. Note that $P$ is algebraically closed in the $L_P$-sense. By stability of $T_P$, $p(y) = \tp_{L_P}(m/P)$ is definable over $P$, hence we have that for every $a \in M$,
\begin{align*}
a \in C  \iff \varphi(a,y) \in p   \iff   M \models d\varphi(a),
\end{align*}
where $d\varphi(x)$ is an $L_P$-formula with parameters in $P$. Now, by Fact 3.2, $d\varphi(x)$ is equivalent to a boolean combination of formulas of the form $\exists z P(z) \land \psi(x,z)$ where $\psi$ is a quantifier-free $L_P$-formula. Since $C \subseteq P^n$ and $$M \models \forall x \ d\varphi(x) \rightarrow P(x),$$ $C$ is $L$-definable by a boolean combination of formulas of the form $\exists z \psi'(x,z)$, where $\psi'$ is the $L$-formula obtained from $\psi$ by replacing every instance of $P(t)$ by $t=t$, for every term $t$. 
\end{proof}

\Remark  By elimination of quantifiers in $T$, the formula $\exists z \psi'(x,z)$ is equivalent modulo $T$ to a quantifier free $L$-formula $\theta(x)$. Notice also that the set $C$ only depends on $m$, so if $c$ is an $L_P$-code for $C$, we have that $c \in \dcl_{L_P}^{\eq}(m)\cap P$.



\Def Let $a \in M$ a (possibly infinite) tuple, define $\widehat{a}= (a,a^c)$, where $a^c = \Cb(\tp_L(a/P))$. Since $T$ is totally transcendental and eliminates imaginaries, $a^c$ is in the $L$-definable closure of a finite real tuple. More specifically, $a^c$ can be regarded up to interdefinability as a tuple of generators for the field of definition of the algebraic locus of $a$ over $P$ (i.e: the variety associated to the prime ideal of polynomials in $P[X]$ that vanish at $a$).

\Lem For all tuples $a \in M$, $\langle \widehat{a} \rangle$ is linearly disjoint from $P$ over  $\langle a^c \rangle$.
\begin{proof}
Note that $\langle \widehat{a} \rangle = \langle a^c \rangle (a)$. Let $\{M_0(X),\dots,M_m(X)\}$ be a set monomials such that  $\{M_0(a),\dots,M_m(a)\}$ is linearly independent over $\langle a^c \rangle$. Suppose there is a linear relation $\sum c_i M_i(a)=0$, where $c_i \in P$. By definition of $a^c$ we can write
$$\sum_{i=0}^mc_iM_i(X) = \sum_{j=0}^n b_j f_j(X),$$
where $b_j\in \langle a^c \rangle$, $f_j(a) \in I := \{ f(X) \in  \langle a^c \rangle(X) , \ f(a) = 0\}$ for all $j$, and such that $\{ f_0(X),\dots, f_n(X) \}$ is a linearly independent set of polynomials over $ \langle a^c \rangle$.  We claim that $\{M_1,\dots,M_m,f_1, \dots,f_n\}$ is also linearly independent over $\langle a^c \rangle$: if it were not, then $\sum r_i M_i(X) + \sum s_j f_j(X)= 0$, for some $r_i,s_j \in \langle a^c \rangle$. We can substitute $a$ for $X$ to obtain $\sum r_i M_i(a) = 0$, which yields $r_i=0$ for all $i$, hence $\sum s_j f_j(X)= 0$ and $s_j = 0$ for all $j$. As these are formal polynomials, they remain linearly independent over $P$, hence $c_i= 0$ for all $i$. \pagebreak
\end{proof}



\Remark For all tuples $a \in M$, $a^c \in \dcl_{L_P}(a)$.
\begin{proof}
Any $L_P$-automorphism leaves $P$ invariant, so if it also fixes $a$, it must leave $\tp_L(a/P)$ invariant, hence it must fix $a^c$. 
\end{proof}

\Lem  For all tuples  $a,b \in M$, $\tp_{L_P}(a) = \tp_{L_P}(b)$ if and only if $\tp_L(\widehat{a})=\tp_L(\widehat{b})$.
\begin{proof}
If there is an $L_P$-automorphism $\sigma$ of $M$ taking $a$ to $b$, by Remark 3.7 we have $\sigma(a^c) = b^c$,  hence $\tp_{L_P}(\widehat{a}) = \tp_{L_P}(\widehat{b})$. Restricting the language yields $\tp_{L}(\widehat{a})=\tp_{L}(\widehat{b})$.  Conversely, assume there is a partial $L$-isomorphism $\sigma$ sending $a$ to $b$ and $  a^c $ to $ b^c $. Since $\langle \widehat{a} \rangle$ and $P$ are linearly disjoint over $\langle a^c  \rangle$, and  also $\langle \widehat{b} \rangle$ and $P$ are l.d. over $\langle b^c \rangle$, the restriction $\sigma \restriction{\langle \widehat{a} \rangle}$ can be extended to an $L$-isomorphism $\sigma':P(a) \to P(b)$ such that $\sigma'(P) = P$ or in other words, to an $L_P$-isomorphism, which can be itself extended to an $L_P$-automorphism of $M$ by saturation of $M$ over $P$ (see Fact 3.2 \textit{(iii)}).
\end{proof}


\Lem For all tuples $a \in M$,
\begin{enumerate}[(i)]
\item $a^c \subseteq P$.
\item If $b \in P$ is a tuple, $\widehat{ab}$ and  $\widehat{a}b$ are $L$-interdefinable.
\item $\widehat{a}  {\forkindep}^{L_P}_{a^c} P$
\end{enumerate}
\begin{proof}
By elimination of imaginaries in $T$, $a^c \in \acl^{\eq}_L(P)=P$, this gives \textit{(i)}. To see \textit{(ii)}, notice that $a \forkindep^L_{a^c} P$ implies $ ab \forkindep^L_{a^c b} P$, and since $\tp_L(ab/a^cb)$ is stationary, we get $(ab)^c \subseteq \dcl_L(a^c b)$, hence $\widehat{ab} \in \dcl_L(\hat{a}b)$. Cleary $\widehat{a}b \subseteq \widehat{ab}$, so the other direction follows.  For \textit{(iii)},  let $a^c \in B \subseteq P$, and choose an $L_P$-indiscernible sequence over $a^c$, $(B_i)_{i<\omega}$, such that $B_0 = B$. Let $p = \tp_L(\widehat{a}/B)$, and for each $i$ let $p_i$ be the image of $p$ under an $L$-automorphism that fixes $a^c$ and sends $B$ to $B_i$. As $\widehat{a} \forkindep^L_{a^c} P$, $B_i \subseteq P$,  and $\widehat{a} \forkindep^L_{a^c} B_i$ for every $i$,   $\hat{a}$ realizes $\cup_i p_i$. By Lemma 3.8 and \textit{(ii)}, $\tp_{L}(\widehat{a}/P) \vdash \tp_{L_P}(\widehat{a}/P)$. If we let $p' = \tp_{L_P}(\widehat{a}/B)$ and $p'_i$ be the image of $p'$ under an $L_P$-automorphism that fixes $a^c$ and sends $B$ to $B_i$, we have proven consistency of $\cup_i p'_i$. Hence, $\tp_{L_P}(\widehat{a}/B)$ does not fork over $a^c$. Since $B$ was chosen arbitrarily, the result follows.
\end{proof}

\Def A subset $A$ of $M$ is said to be $P$-independent if $ A \forkindep^L_{A \cap P} P$.

\Remark
\begin{enumerate}[(i)]
\item For all $a\in M$, $\widehat{a}$ is $P$-independent.
\item Any subset of $P$ is $P$-independent.

\end{enumerate}
\begin{proof}
The first condition follows directly from Lemma 3.9 \textit{(i)}, \textit{(iii)}, and monotonocity. The second statement is clear. 
\end{proof}


\Lem Let $A\subseteq B,C \subseteq M$ with $C = Ac$, where $c \in M$ is a finite tuple. The following are equivalent:
\begin{enumerate}[(i)]
\item $C \forkindep^{L_P}_A B$
\item $C\forkindep^L_{ AP} BP$, and
 $C^c \forkindep_{A^c}^L B^c$.
\item $C\forkindep^L_{ AP} BP$, and
 $\widehat{C} \forkindep_{\widehat{A}}^L \widehat{B}$.

\end{enumerate}

\begin{proof} \ \newline
\textit{(i) }implies\textit{ (ii)}: By Remark 3.7, we may assume $B = \widehat{B}$. For the first part, suppose by contradiction that $ \tp_L(c/BP)$ forks over $AP$. Let $(B_i)_{i <  \lambda}$ be a sequence of realizations of $\tp_L(B / AP)$ such that $B_i \forkindep^L_{AP} (B_j)_{j<i}$ and $B_0 = B$; note that in particular, as $\widehat{B_i} = B_i$, for all $i$, we get $\tp_{L_P}(B_i) = \tp_{L_P}(B)$ by Lemma 3.9. We can choose $\lambda$ large enough to apply Fact 1.19, yielding an $L_P$-indiscernible sequence over $AP$,  $(B'_i)_{i < \omega}$, such that $\tp_{L_P}(B'_i/AP ) = \tp_{L_P}(B/AP ) $ for all $i$.
Let $p = \tp_{L_P}(c/B)$ and let $p_i$ be its copy over $B'_i$; then by \textit{(i)},  $\cup_{i<\omega} p_i$ can be realized by some $c'$. We have that for all $i$, $c' \not\forkindep^L_{AP} B'_iP$: this contradicts the $\omega$-stability of $T$, since $(B'_i)_{i<\omega}$ is also $L$-independent over $AP$. To prove the latter part of \textit{(ii)}, we apply properties of forking: by Lemma 3.9 \textit{(iii)} we have that $\widehat{A}  \forkindep^{L_P}_{A^c} P$, which implies by symmetry and monotonicity that $C^c \forkindep^{L_P}_{A^c} \widehat{A}$. Additionally, Remark 3.7 gives
 \begin{align*}
 C \forkindep^{L_P}_A B &\Rightarrow CC^c  \forkindep^{L_P}_{AA^c} BB^c  \\
 &\Rightarrow C^c  \forkindep^{L_P}_{\widehat{A}} B^c, \ \text{by monotonicity.}
 \end{align*}
 Applying transitivity, $C^c \forkindep^{L_P}_{A^c} B^c$. As these three sets all lie in $P$, we actually get the desired independence in the $L$-sense. 

\noindent \textit{(ii)} implies \textit{(iii)}:   
We will prove $AC^c \forkindep^L_{\widehat{A}}\widehat{B}$ and $\widehat{C} \forkindep^L_{AC^c} \widehat{B}$, then \textit{(iii)} will follow by transitivity and because $A^c \subseteq C^c$. To get the first relation, start from $\widehat{B} \forkindep^L_{B^c} P$ and use $C^c \subseteq P$ to get  $\widehat{B} \forkindep_{B^c} C^c$. Combining this with our hypothesis $C^c \forkindep^L_{A^c} B^c$, we get $C^c \forkindep^L_{A^c}\widehat{B}$, which implies $AC^c \forkindep^L_{\widehat{A}}\widehat{B}$ since $A^c \subseteq \hat{A} \subseteq \hat{B}$. For the second relation, start from $\widehat{C} \forkindep_{C^c} P$ and $A \subseteq C$ to get  $\widehat{C} \forkindep^L_{AC^c} AP$ (I). Now, the hypothesis $C \forkindep^L_{AP}BP$ yields \linebreak $\widehat{C}\forkindep^L_{AP}\widehat{B}$ (II), since $B^c,C^c \subseteq P$. Combining (I) and (II) gives $\widehat{C} \forkindep^L_{AC^c} \widehat{B}$. \pagebreak

\noindent \textit{(iii)} implies \textit{(i)}: \\
\noindent{\textbf{Claim:}  \textit{(iii)} implies $\widehat{Ac}\widehat{B}$ is $P$-independent.}\\
\noindent $\widehat{Ac}\widehat{B}$ is $P$-independent is equivalent to saying that if $t_C$, $t_B$ are transcendence bases for $\widehat{Ac},\widehat{B}$ over $\widehat{A}P = AP$ respectively, then $t_C \cup t_B$ remains algebraically independent over $AP$, which is equivalent to $ C \forkindep^{L}_{AP}BP$.
$_\blacksquare$ \\
\noindent Let $(\widehat{B}_i)_i$ be an $L_P$-indiscernible sequence over $\widehat{A}$ with $\widehat{B_0} = \widehat{B}$. By hypothesis $C^c \forkindep^L_
{\widehat{A}} \widehat{B}$, so we may assume that $(\widehat{B}_i)_i$ is also $L$-indiscernible over $\widehat{A}C^c$. Let $p = \tp_L(\widehat{c} / \widehat{B}C^c)$, and let $p_i$ be its copies over $\widehat{B_i}C^c$. By the first condition of \textit{(iii)}, we can realize $\cup_i p_i$ by some $\widehat{C'}$ which is $L$-independent from $P$ over $\cup_i \widehat{B_i}C^c$.  By Lemma 3.8 and by the claim, it follows that $\tp_{L_P}(\widehat{C}'\widehat{B_i}C^c) = \tp_{L_P}(\widehat{C}\widehat{B_i}C^c)$, %$\tp_L(\widehat{C}/\widehat{B}C^c) \vdash \tp_{L_P}(\widehat{C}/\widehat{B}C^c)$.  Let $p' = \tp_{L_P}(\widehat{c}/\widehat{B} C^c)$ and $p'_i$ be its copies over $\widehat{B_i}C^c$. Then, $\widehat{c}'$ realizes $\cup_i p'_i$, 
so $p$ does not $L_P$-fork over $\widehat{A}$. Therefore, $\widehat{C} \forkindep^{L_P}_{\widehat{A}} \widehat{B}$, and \textit{(i)} follows from Remark 3.7.
%such that %$C' \forkindep^L_{\cup\widehat{B}_iC^c} P$%
%$\tp_L(C'\widehat{B}C^c) = \tp_L(\widehat{C}\widehat{B}C^c)$, this implies by Lemma 3.7 that %$\tp_{L_P}(C' \widehat{B}_i) = \tp_{L_P}(\widehat{C}\widehat{B})$ for all $i$.
\end{proof}
\Lem  Let $a \in M$, then 
\begin{enumerate}[i)]
\item $\acl_{L_P}(a)  = \acl_L (\widehat{a}).$
\item$\dcl_{L_P}(a) = \dcl_L (\widehat{a}).$
\end{enumerate}
\begin{proof}
In both cases, the inclusion $\supseteq$ follows from Remark 3.7.
\begin{enumerate}[i)]
\item

%hence $e \widehat{a} \forkindep^L_{a^c} P$. By saturation of $M$, there are infinitely many $e_i$ such that $\tp_L(e_i\widehat{a}) = \tp_L(e \widehat{a})$, and again as $e,e_i$ are algebraic over $a$, $e^c,e_i^c \subseteq a^c$, so by lemma 1.11 we get $\tp_{L_P}(e_i/a) = \tp_{L_P}(e/a)$ for infinitely many $i$, a contradiction. 

First we show that $\acl_{L_P}(a) \cap P = \acl_L (a^c)$.  Let
$b \in \acl_{L_P}(a) \cap P$, then since $a {\forkindep}^L_{a^c} P$, we get $\widehat{a}{\forkindep}^L_{a^c} b$. Suppose $b \notin \acl_L(a^c)$, so $ b \notin \acl_L(\widehat{a})$. Then, in $P$,  there are infinitely many $(b_i , i < \omega)$ such that $\tp_L(\widehat{a}b_i)=\tp_L(\widehat{a}b)$. By Lemma 3.9 \textit{(ii)}, $\tp_L(\widehat{ab_i})=\tp_L(\widehat{ab})$. By Lemma 3.8, these $b_i$ are also $L_P$-conjugate over $\widehat{a}$, a contradiction. Consider now $b' \in M\setminus P$ such that $b' \in \acl_{L_P}(a)$ but $b' \notin \acl_L(\widehat{a})$. Then
 $$(b'\widehat{a})^c \in \dcl_{L_P}(b'\widehat{a})\cap P  \subseteq \acl_{L_P}(\widehat{a})\cap P = \acl_{L}(a^c),$$
which implies by Fact 1.8 \textit{(iii)} that $b'\widehat{a} \forkindep^L_{a^c} P$, hence $b' \forkindep^L_{\widehat{a}} P$. By assumption there are infinitely many $L$-conjugates of $b'$ over $\widehat{a}$. Since $M$ is saturated over $P$, there are infinitely many realizations of $\tp_{L}(b'/\widehat{a}P)$. This implies there are infinitely many realizations of $\tp_{L_P}(b'/\widehat{a})$, a contradiction.   %$\widehat{a}{\forkindep}^L_{a^c} b$. 
%(note that for all $d \in P$ , $\widehat{d} = d$).
%If $b \notin \acl_L({a^c})$ , then $b \notin \acl_L({\widehat{a}})$, and by saturation of $P$ (fact 1.5), there are infinitely many $b_i \in P$, such that $\tp_L(b_i\widehat{a}) =\tp_L(b\widehat{a})$. As $b$ and $b_i$ are algebraic over $a$ for every $i$, we have that $b^c, b_i^c \subseteq a^c$, so by lemma 1.11,  $\tp_{L_P}(b_ia) =\tp_{L_P}(ba)$, hence $\tp_{L_P}(b_i/ a) = \tp_{L_P}(b /a)$ for infinitely many $b_i$, a contradiction. Now, consider any $e \in M \setminus P$, such that $e \in \acl_{L_P}(a)$, but $e \notin \acl_L(\widehat{a})$. Then $$(e\widehat{a})^c \in \dcl_{L_P}(e\widehat{a})\cap P  \subseteq \acl_{L_P}(\widehat{a})\cap P = \acl_{L}(a^c),$$
%hence $e \widehat{a} \forkindep^L_{a^c} P$. By saturation of $M$, there are infinitely many $e_i$ such that $\tp_L(e_i\widehat{a}) = \tp_L(e \widehat{a})$, and again as $e,e_i$ are algebraic over $a$, $e^c,e_i^c \subseteq a^c$, so by lemma 1.11 we get $\tp_{L_P}(e_i/a) = \tp_{L_P}(e/a)$ for infinitely many $i$, a contradiction.
\item The proof is similar. First, we show that  $\dcl_{L_P}(a) \cap P = \dcl_L (a^c)$, so let \linebreak $b \in \dcl_{L_P}(a) \cap P$. Then, by \textit{(i)}, $b \in \acl_{L}(a^c) $. Suppose $b \notin \dcl_L(\widehat{a})$, then there is $b' \in P$ distinct from $b$ such that $ \tp_{L}(b'  \widehat{a} ) = \tp_{L}(b \widehat{a} )$, and applying Lemma 3.9 \textit{(ii)} and Lemma 3.8 gives $\tp_{L_P} (b'\widehat{a}) = \tp_{L_P}(b\widehat{a})$, a contradiction. Consider now $b' \in M \setminus P$, $b' \in \dcl_{L_P}(a) $, but assume $b' \notin \dcl_{L}(\widehat{a})$. Then 

 $$(b'\widehat{a})^c \in \dcl_{L_P}(b'\widehat{a})\cap P  \subseteq \dcl_{L_P}(\widehat{a})\cap P = \dcl_{L}(a^c),$$

hence $\langle \widehat{a} \rangle (b')$ and $P$ are linearly disjoint over $\langle \widehat{a} \rangle$ . By assumption there are at least two $L$-conjugates of $b$ over $\widehat{a}$, which are also $L_P$-conjugates over $\widehat{a}$ by Lemma 3.8, a contradiction.  
\end{enumerate}
\end{proof}
\Cor If $A \subseteq M$ is such that $A = \widehat{A}$, then $\acl_{L_P}(A) = \acl_{L}(A)$ and $\dcl_{L_P}(A) = \dcl_{L}(A)$. In particular $P$ is algebraically closed in the $L_P$-sense.
\Def
\begin{enumerate}[i)]
\item Consider for every $n>1$, the predicate $l_n(x_1,\dots,x_n)$, which asserts that $x_1,\dots,x_n$ are linearly independent over $E$, that is,
$$l_n(x_1,\dots,x_n) \leftrightarrow \forall e_1,\dots,e_n \left(\bigwedge_i P(e_i) \land \sum_i e_ix_i = 0  \rightarrow \bigwedge_i e_i = 0\right).$$
\item Consider for every $n>1$ and for every $i \in \{ 1,\dots, n \}$, the $(n+1)$-ary function $f_{n,i}(y,x_1,\dots,x_n)$ which gives the $i$-th coordinate of $y$ written as a linear combination of $x_1,\dots,x_n$. More specifically, if $l_n(x_1,\dots,x_n) \land \neg l_n(y,x_1,\dots,x_n) $, then
\begin{align*}
z= f_{n,i}(y,x_1,\dots,x_n) \leftrightarrow 
 \exists z_1, \dots , z_n \left( z = z_i \land y = \sum_j z_jx_j \land \bigwedge P(z_j) \right), \end{align*}
 else, if the condition is not met, define $f_{n,i}(y,x_1,\dots,x_n) = 0$. 
\item Define the language $L_P^{l,f}$ as the language obtained by adjoining to $L_P$ the predicate symbols $l_n$ and $f_{n,i}$, for all $n>1$ and $ i \in \{1,\dots,n \}$. Notice that in this language, $P(x)$ can be defined by the formula $\neg l_n (1,x)$.
\end{enumerate}
The following result is Corollary 15 from [3]:

\Fact Let $N \subseteq M$ be a model of $T_P$, then the inclusion is elementary iff $N$ is an $L_P^{l,f}$-substructure if and only if $N$ is $P$-independent. \newpage

\Cor Let  $A \subseteq M$. Let $C$ be the field generated by $A$ and the $f_{n,i}(A)$ for  all $n>1$ and $i \leq n$. Then $\widehat{A} \subseteq C$, and consequently
\begin{enumerate}[i)]
\item $\acl_{L_P}(A)= \acl_L(C). $
\item $\dcl_{L_P}(A)= \dcl_L(C) .$
\end{enumerate}
\begin{proof} 
 By theorem 7, \S 2, Ch 3. of [6], the field of definition of the locus of $A$ over $P$ is generated by $\{ f_{n,i} (M_0,M_1,\dots,M_n) , n < \omega , i \leq n   \}$, where the tuple $(M_0,M_1,\dots,M_n)$ ranges over the set of monomials formed by elements of $A$. Therefore, $A^c \subseteq C$. From this, we get both $\acl_{L}(\widehat{A}) \subseteq \acl_L(C)$ and $\dcl_{L}(\widehat{A}) \subseteq \dcl_L(C)$, while the reverse inclusion follows from the definability of the $f_{n,i}$. The desired result is obtained by invoking Lemma 3.13.
 %Since the $f_{n,i}$ are definable, it is clear that $\acl_L(C) \subseteq  \acl_{L_P}(K)$. Consider the case $K \subseteq P$, which implies $K=C$. Notice that if $a,b \in M\setminus P$, then $\tp_{L}(a/P) = \tp_{L}(b/P)$, hence $a^c = b^c$ and by lemma 1.7, $\tp_{L_P}(a) = \tp_{L_P}(b)$, which implies that $\acl_{L}(C)$ is algebraically closed in $P$ (in the $L_P$ sense), and since $\acl_{L_P}(P)=P$, we conclude. In the case $K \setminus P \neq \varnothing$,  lemma 13 from [2] implies that $(\acl_L(C) , (\acl_L(C\cap P))$ is a proper pair of algebraically closed fields, and a $L_P^{l,f}$ substructure of $M$, which is elementary by the last corollary. Hence $\acl_L(C)$ is algebraically closed in $M$, in the sense of $L_P$.\\
%Once more by definability of $f_{n,i}$, we obtain $\dcl_L(C) \subseteq \dcl_{L_P}(K) \subseteq \acl_L(C)$. If $a \in \acl_L(C)  \setminus \dcl_L(C) $, then there is $\sigma \in \operatorname{Aut}(\acl_L(C)/C)$ such that $\sigma(x) \neq x$, but since $P$ is algebraically closed, $\sigma$ fixes $\acl_L (C\cap P)$ as a set***, which makes it also a $L_P$-automorphism. Therefore the definable closure of $K$ in the $L_P$ sense is exactly $\dcl_L(C)$.
\end{proof}

\Lem Let $a,b,c \in M$, $p_1 = \tp_{L_P}(a /bc)$ , $p_2 = \tp_{L_P}(b/c)$. If $p_1,p_2$ are stationary, then $p_3 = \tp_{L_P} (a/c)$ is stationary.
\begin{proof}
 By stability of $T_P$ and by hypothesis, there are good definition schemes $dp_1$ over $bc$ and $dp_2$ over $c$. We want to find a good definition for $p_3$, i.e. one that defines a global type, this would imply stationarity by Lemma 1.14. Let $\varphi(x,y)$ be an $L_P$-formula and let $m \in M$ be such that $M \models \varphi(a,m)$. There is a formula $dp_1 (\varphi) (y,z,w)$ such that $M \models dp_1 (\varphi) (m,b,c)$. Moreover, there is then a formula $dp_2(dp_1(\varphi ))(y , w)$ such that $M \models dp_2(dp_1 (\varphi )) (m , c)$. The result follows.
\end{proof}

\noindent \emph{\textbf{Remark:}  $T_P$ eliminates finite imaginaries. }
\begin{proof} Let $A= \{a_1, \dots, a_k \} \subseteq M^n$, where $a_i = (a_{i,1},\dots,a_{i,n})$. Consider the following polynomial
$$p(X,Y_0,\dots,Y_{n-1}) = \prod_{i=1}^k \left(X - \sum_{j =1}^n a_{i,j}Y_j \right),$$
If $\sigma$ is an $L_P$-automorphism, then as it is in particular an $L$-isomorphism, we have that $\sigma p(X,Y_0,\dots,Y_{n-1}) = \prod_{i=1}^k \left(X - \sum_{j =1}^n \sigma(a_{i,j})Y_j \right)$. Noting that $M[X,Y_0,\dots,Y_{n-1}]$ is a unique factorization domain, we deduce $\sigma p = p$ if and only if $ \sigma A = A$. The tuple consisting of the coefficients of $p$ is a canonical parameter for $A$. \pagebreak
\end{proof}

\Lem   Let $M_0$ be an elementary substructure of $(M,P)$, and let $a \in M$ be such that $a = \widehat{a}$. Define $d = \Cb ( \tp_{L}(a/\acl_{L}(M_0  P))$, $e' = \Cb (\tp_{L_P}(d/M_0))$, and \linebreak  $e = \Cb(\tp_{L_P}(a/M_0))$. Then $e'$ and $e$ are $L_P$-interdefinable. 

\begin{proof} Note that by definition of $e,e'$ and because $M_0 \preceq M$, $\tp_{L_P}(a/e)$ and $\tp_{L_P}(d/e')$ are stationary. \\

\noindent \textbf{Claim I: }
\begin{enumerate}[(i)]
\item $a \forkindep^{L_P}_{d} M_0P.$
\item $d \in \acl_{L_P}(aM_0).$
\end{enumerate}
(i): By Lemma 3.12, it suffices to prove $\widehat{ad} \forkindep^L_{ \widehat{d}} \widehat{M_0P}$. Notice that since $(M_0P)^c\subseteq P$, we have $M_0P = \widehat{M_0P}$, then by definition of $d$, $a \forkindep^L_{d} M_0P$ and since $d^c \in P$, monotonicity gives $a\widehat{d} \forkindep^L_{\widehat{d}} \widehat{M_0P}$. It is now enough to prove $(ad)^c = d^c$, which would imply $\widehat{ad} = a\widehat{d}$. By definition of $d$, $\langle ad \rangle$ is linearly disjoint (l.d.) from $\acl_L(M_0P)$ over $\langle d \rangle$, hence $\langle ad \rangle$ and $P(d)$ are l.d. over $\langle d \rangle$. Since $\langle d \rangle$ is l.d from $P$ over $\langle d^c \rangle$, it follows that $\langle ad \rangle$ and  $P$ are l.d over $\langle d^c \rangle$, hence $(ad)^c = d^c$. \newline 
\noindent (ii): Since $aM_0 \forkindep^L_{(aM_0)^c} P$, then $a \forkindep^L_{M_0(aM_0)^c} M_0P$. By Fact 1.8 \textit{(iii)} and Remark 3.7, it follows that $$d \in \acl_L(M_0(aM_0)^c) \subseteq \acl_{L_P}(M_0(aM_0)^c) \subseteq \acl_{L_P}(aM_0). _\blacksquare$$


\noindent\textbf{Claim II: }$d \in \dcl_{L_P}(a,e).$ \newline
Let $\sigma$ be an $L_P$-automorphism that fixes $a,e$, and let $M_0' = \sigma(M_0)$. Choose a realization $M_0''$ of $\tp_{
L_P}(M_0/a,e)$ independently from $M_0 \cup M_0'$ over $a,e$. Using $a \forkindep^{L_P}_e M_0$ and $e \in M_0\cap M_0' \cap M_0'',$ we obtain the following relations
$$a \forkindep^{L_P}_{M_0} M_0M_0'' , \  a \forkindep^{L_P}_{M_0''} M_0M_0'' , \ a \forkindep^{L_P}_{M_0'} M_0'M_0'', \  a \forkindep^{L_P}_{M_0''} M_0'M_0''.$$
Applying Lemma 3.12 gives
$$a \forkindep^L_{PM_0} PM_0M_0'' , \  a \forkindep^L_{PM_0''} PM_0M_0'' , \ a \forkindep^L_{PM_0''} PM_0'M_0'', \  a \forkindep^L_{PM_0'} PM_0'M_0''.$$
Since $\tp_L(a/\acl_L(M_0P))$ is stationary, this translates in terms of canonical bases to $$ d = \Cb ( \tp_L(a /\acl_L(M_0P))) = \Cb ( \tp_L(a /\acl_L(M_0''P))) = \Cb ( \tp_L(a / \acl_L(M_0'P))),$$ hence $\sigma(d) =d$, so the claim is proved.  $_\blacksquare$

\noindent By definition of $e$, $a \forkindep^{L_P}_e M_0$.  As $\tp_{L_P}(a/e)$ is stationary, $e \in M_0$,  and $d \in \dcl_{L_P}(a,e)$, we conclude $\tp_{L_P}(d/e)$ is stationary by Lemma 1.15. Therefore, $e' \in \dcl_{L_P}(e)$.\\
\noindent \textbf{Claim III: } $a \forkindep^{L_P}_{e'} M_0$. Therefore, $e \in \acl_{L_P}(e')$. \\
\noindent By Claim I, 
\begin{align*}
a \forkindep^{L_P}_d M_0P &\Rightarrow a \forkindep^{L_P}_d M_0d \\
& \Rightarrow a \forkindep^{L_P}_{de'} M_0 \quad \text{ as $e' \in \dcl_{L_P}(M_0) = M_0$.}
\end{align*}
By definition of $e'$ we have $de' \forkindep^{L_P}_{e'} M_0$. Applying transitivity yields the claim. $_\blacksquare$

\noindent To prove $e \in \dcl_{L_P}(e')$, we shall show stationarity of $\tp_{L_P}(a/e')$ and apply Fact 1.8 \textit{(iv)}. By definition of $e'$, $\tp_{L_P}(d/e')$ is stationary, then by Lemma 3.18, it would suffice to prove $\tp_{L_P}(a/de')$ is stationary. However, Claim I implies $a \forkindep^{L_P}_d e'$, so it is enough to prove $p = \tp_{L_P}(a/d)$ is stationary. Let $N$ be an $L_P$-elementary substructure of $M$ containing $d$, and suppose $p \subseteq p_1,p_2$ are nonforking extensions of $p$ to $N$. Let $a_1,a_2$ realize $p_1,p_2$ respectively. By Lemma 3.12, $a_i \forkindep^L_{dP} NP$. Since $\tp_{L_P}(a_i/d)= \tp_{L_P}(a/d)$ for $i=1,2$, and $a \forkindep^{L}_d  dP$ (by definition of $d$ and monotonicity), we get that  for $i=1,2$, $ \ a_i \forkindep^L_d NP$. This in turn implies $Na_i \forkindep^L_N P$, since $d \in N$.
Since $N=\widehat{N}$, by Remark 3.11 \textit{(ii)}, $N \forkindep^L_{P \cap N} P$. Applying transitivity yields $N a_i \forkindep^L_{N\cap P} P$, hence $N(a_i)$ and $NP$ are linearly disjoint over $N$. This implies $\widehat{N(a_i)} = N(a_i)$. Since $\tp_L(a/d)$ is stationary, $\tp_L(a_1 N) = \tp_L(a_2N)$.  We can then apply Lemma 3.8 to obtain that $\tp_{L_P}(a_1 N) = \tp_{L_P}(a_2N)$.
\end{proof}

\Lem Let $a \in M$, $A \subseteq M$. If $A = \widehat{A}$ and $\tp_{L_P}(a/A)$ is stationary, then $\tp_{L}(a/A)$ is stationary.
\begin{proof}
Suppose by contradiction that $\tp_{L}(a/A)$ is not stationary and let $k = \langle A \rangle$. The extension $k(a)|k$ is not primary: there is some $\alpha \in k(a)$ such that $\alpha \in \acl_L(k) \setminus \dcl_L(k)$. Note also that $\widehat{k} = k$. By Corollary 3.14,  $\alpha \in \acl_{L_P}(k) \setminus \dcl_{L_P}(k)$, contradicting stationarity of $\tp_L(a/A)$.
\end{proof}

%Applying Lemma 3.12 yields $a_i \forkindep^{L}_{dP} P$. By Claim I, $a \forkindep^L_d dP$, then for $i= 1,2$ , $a_i \forkindep^L_d dP$ (since $\tp_{L_P}(a/d)=\tp_{L_P}(a_i/d)$). Applying transitivity yields $a_i \forkindep^L_d P$. Recall $a = \widehat{a}$, hence $a_i = \widehat{a_i}$. By definition of $d$, $\tp_L(a/d)$ is stationary, so that $\tp_L(a_1N) = \tp_L(a_2N)$. Considering  $N = \widehat{N}$, we may apply Lemma  to obtain  $\tp_{L_P}(a_1N) = \tp_{L_P}(a_2N)$. 


\Lem  Suppose $d \in M$ is such that $d = \widehat{d}$, and let $e \in \dcl^{\eq}_{L_P}(d)$ be an imaginary such that $\tp_{L_P}(d/e)$ is stationary. Let $d' \models \tp_{L_P}(d/e)$ with $d \forkindep^{L_P}_e d'$. Let $B_1' = \dcl^{\eq}_{L_P}(e)\cap M$ and $B_1=\acl^{\eq}_{L_P}(e)\cap M$ . Then $\langle d \rangle$ and $  \langle d' \rangle$ are linearly disjoint over   $B_1'$, in particular $d \forkindep^L_{B_1}d'$. 
\begin{proof} We denote $p(x) = \tp_{L_P}(d/e)$, \\
\noindent \textbf{Claim: } Let $d'' \models p|\{d,d'\} $, then $d \forkindep^L_{d'} d''  d'$ and  $d \forkindep^L_{d''} d'' d'.$ \\
By definition of $d''$, we have $d \forkindep^{L_P}_{d'} d''d'$, and by hypothesis $d \forkindep^{L_P}_e d'$. Additionally,  $e \in \dcl_{L_P}(d'') \cap \dcl_{L_P}(d')$, then both relations  $d\forkindep^{L_P}_{d''} d', \quad d\forkindep^{L_P}_{d'} d''$ hold. Starting from the first relation, we see that $dd'' \forkindep^{L_P}_{d''} d'd''$, and by Lemma 3.11, $\widehat{dd''} \forkindep^{L}_{\widehat{d''}} \widehat{d'd''}$. Since $d,d'$ and $d''$ are independent over $e$, and e is definable over
each of $d,d',d''$, the stationarity of $\tp_{L_P}(d/e)$ implies that of $\tp_{L_P}(d/d''), \tp_{L_P}(d/d')$. It follows by 3.20 that $\tp_L(d/d''), \tp_L(d/d')$ are stationary. Then, as $\widehat{d''} = d''$, we get $d \forkindep^L_{d''} d'' d'$, hence, the field of definition of the locus of $d$ over $\langle d'' d' \rangle$ is contained in $\langle d'' \rangle$. The other part of the claim is obtained similarly, using that $\widehat{d'} = d'$ instead, yielding that the field of definition of the locus of $d$ over $\langle d'' d' \rangle$ is contained in $\langle d' \rangle$. $_\blacksquare$ \newline
We obtain therefore $$\Cb(\tp_L(d/d'))=\Cb(\tp_L(d/d''))\subset \dcl_L(d')\cap \dcl_L(d'').$$
But $d'$ and $d''$ are independent over $e$, $\dcl_{L_P}(d')=\dcl_L(d')$, and
$\dcl_{L_P}(d'')=\dcl_L(d'')$, so $\Cb(\tp_L(d/d')) \subseteq \dcl_{L_P}^{eq}(e)\cap M= B_1'.$
%\noindent Consider now $d''$ as in the claim. By hypothesis, $\tp_{L_P}(d/d')$ is stationary, hence $\tp_{L}(d/d')$ is stationary by Lemma 3.20. By our claim, $\tp_{L}(d/d'd'')$ is also stationary  . Considering $d'' \forkindep^{L_P}_e d'$, then by Lemma 3.13 and stationarity, $$\dcl_{L}(d')\cap \dcl_{L}(d'')\cap M = \dcl_{L_P}(d')\cap \dcl_{L_P}(d'')\cap M \subseteq \dcl_{L_P}(e) \cap M = B_1',$$
%this together with the claim give $\Cb(\tp_{L}(d/d'd'')) \in B_1'$. The result follows.
%\textit{Proof of claim: }
%Notice that $d \forkindep^{L_P}_{\tilde{d}} d'$. Then by Lemma 1.12 we have that $\widehat d \forkindep^L_{\widehat {\tilde{d}}} \widehat d'$, but since $d=\widehat{d}$ and $d \equiv_{L_P} d'\equiv_{L_P} \tilde{d}$, then $d' = \widehat{d'}$ and $\tilde{d} = \widehat{\tilde{d}}$, we get $d \forkindep^L_{\tilde{d}} d'$. The other independence relation is proved analogously.\\
%Now, consider $\tilde{d}$ as in the claim, then by hypothesis, $$\acl_{L_P}(\tilde{d}) \cap \acl_L(d')  = \acl_{L_P}(e)  = B.$$ By Lemma 1.13 , $\acl_{L_P}(d')\cap M = \acl_L(d')$, and the same holds for $\tilde{d}$. Let $c = \cb(\tp_L(d/d',\tilde{d})$, so that by the previous claim and the fact that $T$ eliminates imaginaries, $c \in \acl_{L}(d') \cap \acl_{L}(\tilde{d})\cap M = B$, which implies what we wanted to prove.
\end{proof}

\Lem  Let $e \in (M,P)^{\eq}$, and $B_0 = \acl^{\eq}_{L_P}(e) \cap P$. Then for all $c \in P$, $\tp_{L_P}(c /B_0 e)$ is finitely satisfiable in $B_0$.
\begin{proof} Let $a \in M$ be such that $e = f(a)$ for some definable function. Since $\widehat{aP} = \widehat{a}P$, by Lemma 3.8 $\tp_{L_P}(a/a^c) \vdash \tp_{L_P}(a/P)$. We will prove that $\tp_{L_P}(a/P)$ is stationary, this would imply by Lemma 1.15 that $\tp_{L_P}(e/P)$ is stationary. Suppose not, so we can find $b_1,\dots,b_n \in M$ and formulas $\varphi(x,b_i)$, which distinguish between the non-forking extensions of $\tp_{L_P}(a/a^c)$ to $M$. In other words, they define a partition of the set of realizations of $\tp_{L_P}(a/a^c)$.
By saturation of $M$ over $P$, we may assume $$a\forkindep^{L_P}_{a^c}b_1,\dots,b_n,P.$$ If $a'$ is another realization of $\tp_{L_P}(a/a^c)$, such that $a' \forkindep^{L_P}_{a^c} b_1,\dots,b_n,P$, then there is an autormorphism of $M$ that fixes $\acl_{L_P}(P,b_1,\dots,b_n)$ and sends $a$ to $a'$. This implies $\tp_{L_P}(a'/P) = \tp_{L_P}(a/P)$.
%\textbf{Claim: } $P = \acl^{\eq}_{L_P}(P)$. \\
%\noindent We show first that $P = \dcl^{\eq}_{L_P}(P)$. If $e \in  \dcl^{\eq}_{L_P}(P)$, then $e$ is the code of some $L_P$-definable set $C \subseteq P$. By Lemma 3.3, $C$ is $L$-definable with parameters from $P$, and since $T$ eliminates imaginaries, $e \in P$. Suppose by contradiction that $e \in  \acl^{\eq}_{L_P}(P)\setminus P$. Consder the set of $L_P$-conjugates of $e$ over $P$, given by $\{ e_1 , \dots, e_n\}$. If $e'$ is a code for this set, then $e' \in \dcl_{L_P}^{\eq}(P) =  P$. Since $e \not \in B_0$, we conclude that the group $\operatorname{Aut}_{L_P}(M/B_0)$ has a finite quotient. This is a contradiction, as $B_0$ is $L_P$-algebraically closed.$_\blacksquare$

\noindent Define $e^c = \Cb(\tp_{L_P}(e/P))$. Note that $$e^c \in \dcl^{\eq}_{L_P}(e) \cap \dcl^{\eq}_{L_P}(P)= \dcl^{\eq}_{L_P}(e)  \cap P.$$ 
By definition of $e^c$ we have $e \forkindep^{L_P}_{\acl_L(e^c)} P$, and the proof of Lemma 3.13 shows that $\acl_L(e^c)=B_0$. Hence, $\tp_{L_P}(e/P)$ is stationary and is a non-forking extension of $\tp_{L_P}(e/B_0)$. This implies definability of  $\tp_{L_P}(e/P)$ over $B_0$. Thus, for any $L^{\eq}_P$-formula $\psi(x,y)$ with  parameters in $B_0$, there is a formula $d\psi(y)$ with parameters in $B_0$ such that for all $c \in P$, $M \models \psi(e,c) $ iff $M \models d\psi(c)$. By Lemma 3.3, we may assume that $d\psi(y)$ is an $L$-formula. Since we also have that $B_0 \prec P$ in the sense of $L$, we have that for any $c \in P$, if $P\models \psi(e,c)$ then $P\models d\psi(c)$, which implies there is $b \in B_0$ such that $P\models d\psi(b)$, and therefore $ M \models \psi(e,b)$.
\end{proof}

\section{Weak Elimination of Imaginaries}
\emph{Throughout this section we will maintain our notation and conventions from Section 3. We let $T= ACF_p$, and $T_P$ the theory of beautiful pairs of models of $T$. We have that $(M,P) \models T_P$ is saturated.}

\Def Let $G$ be an algebraic group and $X$ an algebraic variety both defined over $k \subseteq M$. A $k$-rational action is a group action $\alpha:G \times X \to X$ such that for every $g \in G$, the map $\alpha(g, \cdot):X \to X$ is a $k$-rational map.

\Def A definable group action is a triple $((G, \cdot), X , \alpha)$, where $(G,\cdot)$ is a definable group, $X\subseteq M$ a definable set and $\alpha: G \times X \to X$ a group action whose graph is definable. If the action is \textit{transitive} on $X$, that is, for every $a,b \in X$ there is $g \in G$ such that $\alpha(g,a) = b$, the triple is the called a \textit{definable homogeneous space}. Moreover, if the action is \textit{strictly transitive (or regular)}, that is, $\alpha(g,x) = x$ iff $g = e$, it will be called a \textit{principal definable homogeneous space} (or PHS). \\


\noindent {We shall abuse notation and denote $\alpha(g,a)$ as $g \cdot a$.} In our context, as $T=ACF_p$,  we get the following fact from Theorem 7.4.14 of [7].
\Fact If $G \subseteq M^n$ is an $L$-definable group, then $G$ is definably isomorphic to an algebraic group. \\





\Prop  Let $e \in (M,P)^{\eq}$. Then there are: a connected algebraic group $G$, an irreducible variety $V$ over $P$, and a rational action $G$ on $V$, definable over $P$, such that
\begin{enumerate}[(i)]
\item The action of $G(P)$ on $V(M)$ is generically free: if $a \in V(M)$ is a generic point of $V$ over $P$, and $g \in G(P)$ is not the identity, then $g \cdot a \neq a$.
\item For some $a  \in V(M)$ generic over $P$, if $r$ is a canonical parameter for the orbit $X = \{ g\cdot a \ , \ g \in G(P) \}$, then $e \in \dcl_{L_P}(r)$  and $r \in \acl_{L_P}(e)$.
\end{enumerate}

\noindent \emph{The proof of Proposition 4.4 will require some results.}

\Lem  Let $e \in (M,P)^{\eq}$. There is $d' \in M$ such that $\tp_{L_P}(d' / e)$ is stationary and $P$-internal, and moreover $e \in \dcl_{L_P}^{\eq}(d')$.

\begin{proof}
Let $a \in M$ be such that $a=\hat{a}$ and $e = f(a)$ for some $\varnothing$-interpretable function. By Lemma 1.10 we may suppose $\tp_{L_P}(a/e)$ is stationary, hence $e = \Cb(\tp_{L_P}(a/{M_0}))$, where ${M_0}$ is any $L_P$-elementary substructure of $M$ such that $e \in {M_0}^{\eq}$ and $a \forkindep^{L_P}_e M_0$. Let $d = \Cb(\tp_L(a/\acl_L({M_0}P))$. By Lemma 3.19, $e=\Cb(\tp_{L_P}(d/M_0))$, hence $d \forkindep^{L_P}_{e} {M_0}$. Since $M_0 \preceq M$, $\tp_{L_P}(d/M_0)$ is stationary,  $\tp_{L_P}(d/e)$ is stationary and almost $P$-internal. Replacing $d$ by finitely many independent realizations of $\tp_{L_P}(d/e)$, by Fact 1.8 \textit{(v)}, we may asssume without loss of generality that $e \in \dcl^{\eq} (d)$, or that $e = g(d)$ for some definable function $g$. By Lemma 1.17, there is $d' \in \dcl_{L_P}(d)$, a code for a finite set of realizations of $\tp_{L_P}(d/e)$, such that $d \in \acl_{L_P}(d')$ and $\tp_{L_P}(d'/e)$ is stationary and $P$-internal. Then as $d \in \acl_{L_P}^{\eq}(d')$, there is a formula $\varphi(x,d')$ isolating $\tp_{L_P}(d/d')$; hence $M \models \forall x \varphi(x,d') \rightarrow g(x) = e$, so $e \in \dcl^{\eq}(d')$.


%note that $d$ is a finite real tuple, and let $e_1 = \Cb(\tp_{L_P}(d/B))$. By Lemma 3.16, $e$ and $e_1$ are interdefinable, we may assume for the rest of the proof that $e = e_1$. Moreover, as $BP = \widehat{BP}$, by definition of $d$ we have $d \in \acl_L(BP) = \acl_{L_P}(BP)$, and noting that $d \forkindep^{L_P}_e B$, we see that $\tp (d/e)$ is almost internal to $P$. Applying Lemma 1.6 gives an imaginary $d'$ such that $d' \in \dcl_{L_P}(d,e)$, $d \in \acl_{L_P}(d')$ and $\tp_{L_P}(d'/e)$ is $P$-internal and stationary. Let now $e' = \Cb(\tp_{L_P}(d'/e))$, so $e' \in \dcl_{L_P}(e)$ , and as $d \in \acl_{L_P}(d')$, by definition of $e'$, $d \forkindep^{L_P}_{e'} e$, hence  $e \in \acl_{L_P} (e')$.
\end{proof}

\Lem  There are a tuple $d \in M$, an $L_P$-definable function $f$ (over $\varnothing$), an $L_P(e)$-formula $\psi(x)$, and an $L_P(e)$-definable function $h$ such that
\begin{enumerate}[(i)]
\item $f(d) = e.$
\item $\psi(x) \in \tp_{L_P}(d/e).$
\item $M \models \forall x, x' (\psi(x) \land \psi(x') \rightarrow \exists c ( P(c) \land h(x,c) = x')$.
\end{enumerate}
\begin{proof}
Let $d'$ be as in Lemma 4.5.  Then $p = \tp_{L_P}(d'/e)$ is stationary, $P$-internal, and $e = \Cb(p)$. By Lemma 1.18, there is a tuple $d$ consisting of finitely many realisations of $p$, and an $e$-definable function $g$ such that for any realization $d''$ of $p$, there is a tuple $c_{d''} \in P$ such that $d'' = g(d,c_{d''})$. Clearly $e \in \dcl_{L_P}^{\eq}(d)$, so we can find an $L_P$-definable function $f$ such that \textit{(i)} holds. If $d_1,d_2$ realize $\tp_{L_P}(d/e)$, then there is an $e$-definable function $h$ and a tuple $c \in P$ such that $d_1 = h(d_2,c)$. Applying compactness yields an $L_P$-formula $\psi \in \tp_{L_P}(d/e)$ such that for any two $d_1,d_2$ satisfying $\psi$, there is $c\in P$ such that $h(d_1,c)=d_2$, which directly proves \textit{(ii)} and \textit{(iii)}. Note $\tp_{L_P}(d/e)$ remains $P$-internal.
%By Fact 1.8 \textit{(v)}, $e \in \dcl(d'_1,\dots,d'_m)$ for some $m$. Note that for all $n$, the type $q = \tp_{L_P}(d'_1,\dots,d'_n/e)$ is also $P$-internal by indiscernibility. Then by Lemma 1.18, for $n$ large enough, there is an $e$-definable function $h$, such that for any realization $(d''_1,\dots,d''_n)$ of $q$, there is a tuple $c \in P$ such that $(d''_1,\dots,d''_n)=h(d'_1,\dots,d'_n,c)$. Let $s= \max\{n,m\}$ and rename $d = (d'_1,\dots,d'_s)$ so \textit{(i)} holds. If $d_1,d_2$ realize $\tp_{L_P}(d/e)$, then there is a tuple $c \in P$ such that $d_1 = h(d_2,c)$. Applying compactness yields an $L_P$-formula $\psi \in \tp_{L_P}(d/e)$ such that for any two $d_1,d_2$ satisfying $\psi$, there is $c\in P$ such that $h(d_1,c)=d_2$, which directly proves \textit{(ii)} and \textit{(iii)}.
\end{proof}
\pagebreak



\Lem  In Lemma 4.6, $d$ can be chosen such that \textit{(i),(ii),(iii)} hold, and $d \forkindep^{L_P}_e P$. 
\begin{proof}
Let $\psi$ as in Lemma 4.6. Let $\chi(x,y)$ an $L_P(e)$- formula that expresses the conjunction of $x^c = y$, $\psi(x)$ and $f(x) = e$. Consider the $L_P(e)$-formula $\theta(y)$ given by $\exists x ( \chi(x,y))$. Since $M \models \theta(d^c)$, by Lemma 3.22, there is $d_0 \in \acl^{\eq}_{L_P}(e)\cap P$ such that $M \models \theta(d_0)$. Therefore, there is $d_1$ such that $M \models \chi(d_1,d_0)$, hence $d_1 \forkindep^{L_P}_e P$. 
%We argue by contradiction, if $d \not\forkindep^{L_P}_e P$, then $d^c \not \in \acl_{L_P}^{\eq}(e)$ and 
%$$m = RM(\tp_{L_P}(d/d^c,e))< RM(\tp_{L_P}(d/e)).$$
%\noindent \textbf{Claim: } There is a formula $\chi(x,b,e)\in \tp_{L_P}(d/b,e)$  such that for any $b' \in P$, if $\chi(x,b',e)$ is consistent, then $RM(\chi(x,b',e))=m.$\\
%\noindent \textit{Proof: } Notice that $b \in P$ implies $\tp_{L_P}(d/b,e)$ is $P$-internal, so let $d' \forkindep^{L_P}_e d$ be such that $d \in \dcl_{L_P}(d',e,P)$, hence $g(c)=d$ for some $c \in P$ and some $d',e$-definable function $g$, and let $\varphi(c,d,d',e)$ be a formula expressing this. Notice that for all $a \in M$, the fiber $g^{-1}(a)$ is definable over $a,e,d'$ (uniformly over $a$). Let $k = RM(g^{-1}(d))$, then by Lemma 1.23, the set $D= \{ a \in M, RM(g^{-1}(a)) = k \}$ is definable over $d',e$, and contains $d$. Since $d$ and $d'$ are independent over $e$, $$m = RM(\tp_{L_P}(d/e,b)) = RM(\tp_{L_P}(d/b,d',e)),$$
%hence we can find some $(b,d',e)$-definable set $D' \subseteq D$ containing $d$, and such that $RM(D')=m$. Let $\psi(x,b,d',e)$ be a formula defining $D'$. Define $B = g^{-1}(D') \subseteq P$, hence $g:B \to D'$ is an $(b,d',e)$-definable surjection whose fibers have Morley rank $k$, and by Lemma 1.17, we conclude $RM(B) = m+k$. Consider now a formula $\theta(x,y,z,e)$ expressing the conjunction of the following:
%\begin{enumerate}[(i)]
%\item $\psi(x,y,z,e).$ \
%\item $\varphi(w,v,z,e)$ defines a function $g_z : P^{|w|} \to M^{|v|}$, whose %image contains $\psi(M,y,z,e)$.
%\item $RM(g^{-1}_z(\psi(M,y,z,e)))=m+k.$
%\item $\forall v  \ (\psi(v,y,z,e) \rightarrow RM(g^{-1}_z(v)) = k).$
%\end{enumerate}
%Conditions \textit{(iii)} and \textit{(iv)} are expressible in first order due to Lemma 1.18. Moreover, notice that conditions \textit{(ii),(iii),(iv)} do not involve $x$, so for any $b_0 \in P,d_0 \in M$, if $\theta(x,b_0,y_0,e)$ is consistent, it is equivalent to $\psi(x,b_0,d_0,e)$. Clearly we have $\models \theta (d,b,d',e)$, and for any $b' \in P$, if $\theta(x,b',d')$ is consistent, then it has Morley rank $m$, since it is the image of a definable surjection whose domain has rank $m+k$ and whose fibers have rank $k$. We can therefore take $\chi(x,b,e)$ to be $\exists z \theta(x,b,z,e)$. $_\blacksquare$\\
%\noindent   If $\psi$ is as in Lemma 4.6, consider the $L_P(e)$-formula $\delta(y)$ given by
%$$\exists x \bigg( f(x) = e \land \chi(x,y) \land \psi(x) \land \forall x', x'' \big(\psi(x')\land \psi(x'')  \rightarrow \exists c \big(P(c) \land h(x',c) = x''\big)  \big)\bigg).$$
%We are assuming $\models \delta(d^c)$. By Lemma 3.22, there is $b \in \acl_{L_P}^{\eq}(e) \cap P$ such that $\models \delta(b)$, which implies there is $d'$ realizing $\tp_{L_P}(d/e)$, such that $M \models \chi(d',b)$. Then we have that
%$$RM(\tp_{L_P}(d/e)) = RM(\tp_{L_P}(d'/e)) = RM(\tp_{L_P}(d'/b,e)) \leq m,$$ a contradiction.
\end{proof}
\noindent \emph{\textbf{Notation: }For the remainder of this section, fix $d$ as in Lemma 4.7. By Remark 3.7 $d^c \in \dcl_{L_P}(d)$, hence we may also assume from now on that $d = \widehat{d}$, as all of the properties from Lemmas 4.6, 4.7, and 4.8 still hold after adjoining $d^c$ to $d$. From now on, let \begin{align*} 
B&= \acl^{\eq}_{L_P}(e), \\ B_1 &= B\cap M, \\ B_0 &= B \cap P.
\end{align*}}
\Lem  $\tp_{L_P}(d/B)$ is isolated.
\begin{proof}
By stability of $Th(M^{\eq})$, there are $M_1 \preceq M$, a prime model over $Bd$ and $M_0 \preceq M_1$ a prime model over $B$. \newline
\noindent \textit{Claim: $B_0 =  M_0 \cap P =  M_1 \cap P$}: It is clear that $B \subseteq M_0,M_1$, one inclusion follows. Conversely, if $a \in M_0 \cap P$, then $\tp_{L_P}(a/B)$ is isolated, which is a non-forking extension of $\tp_{L_P}(a/e)$, hence $\tp_{L_P}(a/e)$ is isolated too, and applying Lemma 3.22, it can be realized by some $a' \in B_0$. In particular, this implies $a \in \acl_{L_P}(e)$. The proof for the second equality is similar,  let $a \in M_1 \cap P$, then $\tp_{L_P}(a/Bd)$ is isolated. Recall $d\forkindep^{L_P}_{e} P$, hence $\tp(a/Bd)$ does not fork over $\tp_{L_P}(a/e)$, which is then isolated, and applying Lemma 3.22 yields the result. \newline
\noindent Let $\psi$ be as in Lemma 4.6, and choose $d' \in M_0$ such that $M \models \psi(d')$. Applying Lemma 4.6 \textit{(iii)} inside the model $M_1$, there is $c \in P \cap M_1 = B_0$ such that $d \in \dcl_{L_P}(d',c) \subseteq M_0$, hence by definition of a prime model, $\tp_{L_P}(d/B)$ is isolated. 
\end{proof}

\Lem  Let $X$ be the set of realizations of $\tp_{L_P}(d/B)$. There are: a connected algebraic group $G$ defined over $B_0$ and an $L_P(e)$-definable regular action of $G(P)$ on $X$. Moreover, if $r$ is a canonical parameter for the PHS $(G(P),X)$, then $e \in \dcl_{L_P}(r)$  and $r \in \acl_{L_P}(e)$.
\begin{proof}
By Lemma 4.8, $X$ is $L_P$-definable over $B$. Define $$C= \{c \in P ,\  \exists d'  ( d' \in X   \land h(d,c)=d') \},$$ which is non empty by Lemma 4.6 \textit{(iii)}, and $L(B_0)$-definable by Lemma 3.3. Consider now the equivalence relation $E$ in $C$ defined by $M \models  E(c_1,c_2)$ if and only if $ M \models h(d,c_1) = h(d,c_2)$. In $C/E$ we can define an $L_P(e)$-interpretable function $h'(d,c/E)) = h(d,c)$. By Lemmas 4.7 and 4.8 $d \forkindep^{L_P}_B P$, hence all elements of $X$ have the same $L_P$-type over $BP$. Since $E$ is contained in some power or $P$, it is $L(B_0)$-definable, hence it does not depend on the choice of $d$. This implies that for all $c_1,c_2 \in C$ the value of $h(h(d,c_1),c_2)$ is defined, and taking classes modulo $E$, there is a unique $c_3/E$ such that $h'(h'(d,c_1/E),c_2/E) = h'(d,c_3/E)$, we define a binary operation on $C/E$ as $(c_1/E) \cdot (c_2/E) = c_3/E$. Once again by Lemma 3.3, this operation is $L(B_0)$-definable. Moreover, by Remark 3.4, we may assume without loss of generality that $C/E$ contains real tuples. \newline
\noindent \textbf{Claim:} $(C/E,\cdot)$ is a $B_0$-definable group.\newline
\noindent Let $c_1,c_2,c_3 \in C/E$. To check associativity, notice that
$$h'(d,(c_1c_2)c_3) = h' ( h' (d,c_1c_2),c_3) = h'(h'(h'(d,c_1),c_2),c_3),$$
moreover, since $h'(d,c_2c_3)$ $= h'(h'(d,c_2),c_3))$ and $\tp_{L_P}(h'(d,c_1)/BP)$ $= \tp_{L_P}(d/BP)$, we obtain
$$h'(d,c_1(c_2c_3)) = h'(h'(d,c_1),c_2c_3) = h'(h'(h'(d,c_1),c_2),c_3)).$$
To check for an identity, by Lemma 4.6 \textit{(iii)}, there is $c' \in P$ such that $h(d,c')=d$. Then, for all $d' \in X$, $h'(d',c') = d'$, in particular
$$h'(d,c_1c') = h'(h'(d,c_1),c') = h'(d,c_1) \Rightarrow c_1c' = c_1.$$
To check the existence of inverses, notice that since $h(d,c_1) \in X$, there is some $L_P$-automorphism $\sigma$ fixing $BP$ pointwise such that  $h(d,c_1) = \sigma(d)$, which implies \linebreak $h'(\sigma^{-1}(d), c_1) = d$. By Lemma 4.6 \textit{(iii)}, there is a unique $c_1'$ such that $h'(d,c_1') = \sigma^{-1}(d)$, hence
\begin{align*}
h'(d,c_1'c_1) = h'(h'(d,c_1'),c_1) = h'(\sigma^{-1}(d), c_1) = d &= h'(d,c'), \\
h'(d,c_1c_1') = h'(h'(d,c_1),c_1') = h'(\sigma(d), c_1') = d &= h'(d,c'),
\end{align*}
therefore, $c_1c_1' =c_1'c_1= c'$. $_\blacksquare$ \newline
\noindent By the previous claim and by Fact 4.3, $C/E$ is $B_0$-definably isomorphic to some algebraic group $G$ over $B_0$. We can then induce an $L(B_0)$-definable action of $G(P)$ over $X$ using the map $h'$: if $F:G \to C/E$ is an isomorphism, then for $(g,d) \in G\times X $, define $g \cdot d = h'(d,F(g)).$ By Lemma 4.6 \textit{(iii)} and by definition of $E$, this action is regular. As $X$ is the set of realizations of a stationary type, $G(P)$ must be connected (as an $L_P$-definable group), hence connected as an algebraic group. Clearly, the PHS $(G(P),X)$ is $L_P$-definable over $B$, this implies that if  $r$ is a canonical parameter for $(G(P),X)$ , then $r \in \acl_{L_P}(e)$. Moreover, if $\sigma$ is some $L_P$-automorphism fixing $r$, then it permutes the realizations of $\tp_{L_P}(d/B)$, and by stationarity of $\tp_{L_P}(d/e)$ we have $e = \Cb(\tp_{L_P}(d/B))$, so $\sigma(e) = e$, hence $e \in \dcl_{L_P}(r)$, completing the proof.
\end{proof}

\noindent \emph{The set $X$ from Lemma 4.9 will be identified with a generic orbit of the action of $G(P)$ over some variety $V(M)$. We first state Proposition 2.2 from [4].}

\Lem Let $G$ be a connected definable group with a generic action on the set of realizations $X_1$ of a stationary $L$-type $q$, that is, for all generic $g \in G$ and for $d$ realizing $q|g$, $g \cdot d$ is defined and realizes $q$, and for all independent $g_1,g_2,d$,  $g_1\cdot(g_2\cdot d) = (g_1g_2)\cdot d$ when the action is defined. There exists then a type-definable set $Y$, a definable embedding $X_1 \subseteq Y$, and a definable action of $G$ on $Y$, extending the generic action of $G$ on $X_1$. Moreover, for every $y \in Y$ there is $g \in G$ and $d \models q$ such that $y= g \cdot d$.
\begin{proof}
Consider the set of pairs $(g,d)$ with $g \in G$, $d \models q$. Define an equivalence relation over these pairs by: $(g,d) \sim (g',d') $ if for all generic $h \in G$ such that $(hg)\cdot d = (hg')\cdot d'$. Let $Y$ be the set of classes, its elements are denoted by $[g,d]$. If $(hg_2) \cdot d = (hg_2')\cdot d'$ holds for  generic $h$, then, since $hg_1$ is also generic, it is also true that $(hg_1g_2) \cdot d = (hg_1g_2')\cdot d'$, hence we can define an action of $G$ on $Y$ by $g_1 \cdot [g_2,d] = [g_1g_2,d]$, and identify each $d\models q$ with $[1_G,d]$. To check the last statement, let $[g,d] \in Y$, and let $h$ be a generic of $G$, independent from $d$, then $h[g,d] = [hg,d] = [1,hg \cdot d]$, hence $[g,d]=h^{-1}[1,hg\cdot d]$.
\end{proof}

\Lem  For $X$ as in Lemma 4.9 there is an irreducible variety $Y$ defined over $B_1$, and a transitive rational action of $G$ on $Y$, defined over $B_1$, such that $X \subseteq Y$, d is a generic point of $Y$ over $B_1$, and the action of $G$ on $Y$ restricts to the given action of $G(P)$ on $X$.
\begin{proof}
Recall that for $g \in G(P)$, $d \in X$, $g \cdot d$ is $e$-definable, this means $g \cdot d \in \dcl_{L_P}(g,d,e)$. Since $e \in \dcl_{L_P}(d)$, then $g \cdot d \in \dcl_{L_P}(g,d) = \dcl_{L}(\widehat{g,d})$ by Lemma 3.13. But $\dcl_L(\widehat{g,d}) = \dcl_L(g,d)$ by Lemma 3.9 \textit{(ii)}. Therefore, $g \cdot d \in \dcl_L(g,d)$. \newline
\noindent{\textbf{Claim: }} $d \forkindep^L_{B_0} g$. \newline
\noindent If $e^c = \Cb(\tp_{L_P}(e/P))$, then $e \forkindep^{L_P}_{e^c} P$, and by Lemma 4.7, $d^c \forkindep^{L_P}_e P$. Applying transitivity yields $d^c \forkindep^{L_P}_{e^c} P$, and since everything lives in $P$, we can restrict our language to get $d^c \forkindep^{L}_{e^c} P$. By the proof of Lemma 3.13,  $B_0 = \acl_{L}(e^c)$, hence  $d^c \forkindep^{L}_{B_0} P$ and by definition of $d^c$ we have $d \forkindep^L_{d^c} P$. The claim follows as $g \in P$. $_\blacksquare$ \newline 



\noindent Now, working in $L$, since $e \in \dcl_{L_P}(d) = \dcl_L(\widehat{d})$, $B_1 \in \acl_L(d)$, so the previous claim yields $dB_1 \forkindep_{B_0} g$. Then, if $g$ is generic over $B_0$, then it is generic over $d B_1$. 
The action is generically regular and transitive: given independent
$d_1,d_2 \in X$, there is a unique $g \in G(P)$ such that $g\cdot d_1=d_2$. Hence, working in $L_P$, $RM(G)=RM(X)$, and if $g\in G$, $d\in X$ are independent over $e$, then
because the action is defined over $e$, we have that $g \in \dcl_L(g\cdot
d,d)$, so  that we must have $RM(g\cdot d,d /e)= 2 RM(G)$, which implies $g \cdot d \forkindep^{L_P}_e d$. By Lemma 3.21,  $g \cdot d \forkindep^{L}_{B_1} d$.


\noindent We have a definable action of $G(P)$ on the $L_P$-definable set $X$, and the
action is given by a map $G \times X \to X$ which is $L(B_1)$-definable in $T$.
Passing to the Zariski closure, we get a generic action of the algebraic
group $G(M)$ on the set $X_1$ of generic elements (over $B$) of the Zariski
closure of $X$. By Lemma 4.10, there is a type-definable $Y\supseteq X_1$ (in the $L$-sense, and over $B_1$) such that $G$ acts on $Y$ in a way that restricts to the generic action of $G$ on $X_1$. Moreover, for every $y \in Y$ there is $g \in G$ and $d \in X_1$ such that $y = g\cdot d$, so the action of $G$ on $Y$ transitive, then $Y$  has a unique generic type by connectedness of $G$, and it must be indeed $\tp_L(d/B_1)$. This proves that $d$ is a generic of $Y$ over $B_1$. We claim that $Y$ is also definable: Let $\varphi(x,y)$ be some $L(B_1)$-formula defining $x \in G \cdot y$, and let $E$ be the equivalence relation given by $yEy'$ iff $ M \models \forall x \varphi(x,y) \leftrightarrow \varphi(x,y')$, by transitivity, for any $y \in Y$ we have $[y]_E = Y$, now by type-definability of $Y$ over $B_1$, $Y$ is fixed by all $\sigma \in \Aut(M/B_1)$, hence the imaginary $[y]_E$ is fixed too, which implies $[y]_E$ is $B_1$-definable, hence $Y$ is $B_1$-definable . Since $X \subseteq X_1 \subseteq Y$, and the action of $G$ on $Y$ restricts to the generic action over $X_1$, then it restricts to the action of $G$ on $X$ that was defined in Lemma 4.9 Finally, by Fact 4.3, $(G,Y,\cdot)$ is $B_1$-definably isomorphic to $(G',Y',\cdot')$, where $G'$ is an algebraic group, $Y'$ an irreducible variety, and $\cdot'$ is a $B_1$-rational action.
\end{proof}
\noindent\textbf{\emph{Proof of Proposition 4.4}}
\begin{proof}
For $e \in M^{\eq}$, $d,G,Y$ as in Lemma 4.11, choose some finite $b \in B_1$ such that $(G,Y,\cdot)$ is definable over $b$. Rewrite $Y$ as $Y_b$. By Lemma 4.7, $d \forkindep^{L_P}_e P$, together with $e \forkindep^{L_P}_{B_0} P$ implies that $bd \forkindep^{L_P}_{B_0} P$ (recall $b \in \acl_{L_P}(e)$). Since $e \forkindep^{L_P}_{e^c} P$, and $(bd)^c \forkindep^{L_P}_e P$, applying transitivity yields $(bd)^c \forkindep^{L_P}_{e^c} P$, and since everything lives in $P$, we can restrict our language to get $(bd)^c \forkindep^{L}_{e^c} P$. By the proof of Lemma 3.13,  $B_0 = \acl_{L}(e^c)$, hence  $(bd)^c \forkindep^{L}_{B_0} P$ and by definition of $(bd)^c$ we have $bd \forkindep^L_{(bd)^c} P$, applying transitivity once more yields $bd \forkindep^{L_P}_{B_0} P.$ Let $V,Z$ be the loci of $bd$ and $b$ over $B_0$, respectively, and consider the projection $f:V \to Z$ sending $bd$ to $b$, then note that $f^{-1}(b) = Y_b$. Then by compactness, there is a Zariski open subset $U$ in $Z$, also defined over $B_0$, such that $G$ acts rationally in $f^{-1}(U)$ and this action restricted to $Y_b$ coincides with the one defined in Lemma 4.9. This proves \textit{(i)}, as any generic $a \in V$ has the same $L$-type over $B_1$ as $b d$, and the action in Lemma 4.9 is regular by construction. Since $f^{-1}(U)$ is still a variety, by shrinking $V$ we may without loss of generality let $V= f^{-1}(U)$, and by $bd \forkindep^{L}_{B_0} P$, we conclude $bd$ is a generic point of $V$ over $P$, therefore \textit{(ii)} follows by applying Lemma 4.9.
\end{proof}
\noindent\emph{We state our main result, which will follow from Proposition 4.4.}
\Cor There is a set of sorts $\mathcal S \subseteq L^{\eq}$, such that $T_P$ has weak elimination of imaginaries in the language obtained by adjoining $\mathcal S$ to $L$.
\begin{proof}
Let $G,V$ be as in Proposition 4.4, and let $c \in P$ generate a field over which $(G,V,\cdot)$ are defined. There is a variety $Z$ defined over the prime field such that there exist varieties $\mathcal G, \mathcal V$, along with surjective regular maps to $Z$, and for each $b \in Z$, the fiber $\mathcal{G}_b$ is an algebraic group that acts on $\mathcal V_b$, and moreover $\mathcal G_c = G$ and $\mathcal V_c = V$. For each $e \in M^{\eq}$, we define a sort $S_{(\mathcal G,\mathcal V, Z,e)}$ in the following manner: let $W_e = \cup \{ \mathcal V_b , b \in Z(P)\}$, and define an equivalence relation on $W$ as $w_1 \sim w_2$ iff for some $b \in Z(P)$, $w_1,w_2 \in \mathcal V_b$ and there exists $g \in \mathcal G_b(P)$ such that $w_1 = g \cdot w_2$. We interpret the elements of $S_{(\mathcal G,\mathcal V, Z,e)}$ as the classes of $W$ modulo $\sim$, which are in turn representatives of each orbit of the fiberwise action of $\mathcal G$ on $\mathcal V$. By Proposition 4.4, for every $e \in M^{eq}$, there is $r \in S_{(\mathcal G,\mathcal V, Z,e)}$, such that $e \in \dcl_{L_P}(r)$ and $r \in \acl_{L_P}(e)$.
\end{proof} \newpage
\begin{thebibliography}{3}

\bibitem{beny1} 
I. Ben-Yaacov, A. Pillay , E. Vassiliev ,  
\emph{Lovely pairs of models, Annals of Pure and Applied Logic 122 (2003) 235-261.}

%\bibitem{beny2} 
%I. Ben-Yaacov, F.O. Wagner,  
%\emph{On almost orthogonality in simple theories, Journal of Symbolic Logic 69 (2004) %398-408.}

\bibitem{buech} 
S. Buechler  .
\emph{Pseudoprojective strongly minimal sets are locally projective, Journal of Symbolic Logic 56 (1991) 1184-1194.}


\bibitem{fran} 
F. Delon  .
\emph{√âlimination des quantificateurs dans les paires de corps alg√©briquement clos. Confluentes Mathematici, Vol. 4, No. 2 (2012) 1250003 , 1-11.}

\bibitem{Hrush}
E. Hrushovski.
\emph{Locally modular regular types, in J.T Baldwin (Ed.), Classification Theory, Lecture Notes in Mathematics, vol. 1292, Springer, 1987}.

\bibitem{Keisler}
H.J. Keisler.
\emph{Complete theories of algebraically closed fields with distinguished subfields, Michigan Mathematics Journal. 11 (1964) 71-81}.

\bibitem{Lang}
S. Lang.
\emph{ Introduction to Algebraic Geometry. Interscience (1958), 62.}


\bibitem{mark}
D. Marker,
\emph{Introduction to Model Theory, Springer (2002), 273-277.}

\bibitem{gst} 
A. Pillay. 
\emph{Geometric Stability Theory, Oxford University Press (1996).}


\bibitem{anan} 
A. Pillay. 
\emph{Imaginaries in pairs of algebraically closed fields. Annals of Pure and Applied Logic 146 (2007) 13-20.}
 

\bibitem{anan2} 
A. Pillay, E. Vassiliev,
\emph{Imaginaries in beautiful pairs. Illinois Journal of Mathematics 48 (2004) 759-768.}

\bibitem{poiz}
B. Poizat.
\emph{Stable Groups, American Mathematical Society, Providence, RI (2001)}

\bibitem{poz} 
B. Poizat.
\emph{Une th√©orie de Galois imaginaire, Journal of Symbolic Logic 48 (1983) 1151-1170}.

\bibitem{TZ}
K. Tent , M Ziegler.
\emph{A course in Model Theory, Cambridge University Press (2012)}

\end{thebibliography}

\end{document}
