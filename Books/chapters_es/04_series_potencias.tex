\chapter{Soluciones por Series de Potencias}

En esta sección vamos a introducir un nuevo método de resolución de ecuaciones diferenciales. Para aplicar este método, debemos retomar el concepto de \textbf{serie de potencia}, el cual nos va a permitir encontrar soluciones de manera \textit{analítica.} Recordemos que una serie de potencias centrada en un número $a$ es una suma infinita de la forma
\begin{equation}\label{eqn:12}
\sum_{n=0} ^ \infty c_n(x-a)^n = c_0 + c_1(x-a) + c_2 (x-a)^2 + \dots
\end{equation}
donde $a,c_n \in \mathbb{R}$ (o incluso $\mathbb{C}$). 

Las series de potencia nos ayudan a aproximar funciones, de hecho, decimos que una serie de potencias \textbf{converge a una función $f(x)$} si en algún intervalo $I \subseteq \mathbb{R}$ se cumple que 
$$f(x) = \lim_{K \to \infty} \sum_{n=0} ^ K c_n(x-a)^n , \quad \text{para todo $x \in I$}$$
o en otras palabras, si las sumas parciales de la suma se van a acercando cada vez más a un valor $f(x)$. Damos aquí rápidamente un repaso de los conceptos clave acerca de la convergencia de las series de potencia. Asumamos que nuestra serie está definida únicamente en los números reales.

\begin{definicion}{Convergencia}{}
    Considere la serie de potencias \eqref{eqn:12}.
\begin{itemize}
\item \textbf{Intervalo de convergencia: }Es el intervalo de números reales $x$ donde la serie converge.
\item \textbf{Radio de convergencia: }El intervalo de convergencia $I$ se puede expresar de la forma $I = [a-R,a+R]$, donde $R \geq 0$. A este número $R$ le denominamos radio de convergencia \linebreak (si $R = \infty$, decimos que $I=\mathbb{R}$).
\end{itemize}
\end{definicion}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{Recorte7.png}
    \caption{Comportamiento asintótico de una serie de potencias convergente.}
    \label{fig:convergencia_asintotica}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{Recorte9.png}
    \caption{Función exponencial y su aproximación por series de potencias.}
    \label{fig:exponencial_serie}
\end{figure}

Un caso especial de las series de potencias son las series de Taylor (y Maclaurin).

\begin{definicion}{Serie de Taylor}{}
    Dada una función $f:\mathbb{R} \to \mathbb{R}$ infinitamente diferenciable, definimos su serie de Taylor centrada en $a$ como la suma
$$S(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^n.$$
Cuando $a=0$, la llamamos serie de Maclaurin.
\end{definicion}

Vamos a conectar estos conceptos de cálculo diferencial con nuestro interés en ecuaciones diferenciales con la siguiente definición. 

\begin{definicion}{Punto Ordinario}{}
    Considere la ecuación diferencial lineal de segundo orden
\begin{equation}\label{eqn:13}
y''+ P(x)y' + Q(x)y = 0
\end{equation}
Decimos que un punto $x_0$ es un \textbf{punto ordinario} de la ecuación \eqref{eqn:13} si ambas funciones $P$ y $Q$ son analíticas en $x_0$. Aquellos puntos que no sean ordinarios, se llaman \textbf{puntos singulares}.
\end{definicion}

\begin{ejemplo}
    Considere la ecuación 
$$x^2y'' - 2y' + xy = 0$$
(note que ningún método de los que tenemos puede resolver esta ecuación). El punto $x=1$ es un punto ordinario de la ecuación, puesto que las funciones 
$$P(x) = -\frac{2}{x^2} \ , \ Q(x) = \frac{1}{x}$$
son ambas analíticas en $1$. Sin embargo, el punto $x=0$ es singular, puesto que $P'(0)$ y $Q'(0)$ ni siquiera se pueden definir (para que una función sea analítica, tiene que ser por lo menos infinitamente diferenciable).
\end{ejemplo}

\section{Solución en una vecindad de un punto ordinario}
Tenemos entonces el primer teorema que nos ayuda a resolver ecuaciones por medio de series. 

\begin{teorema}{}{}
    Si $x_0$ es un punto ordinario de una ecuación en la forma \eqref{eqn:13}, podemos encontrar dos soluciones linealmente independientes $y_1,y_2$ en forma de series de potencias centradas en $x_0$. Estas series convergen para todo $x$ que esté entre $x_0$ y el punto singular más cercano.
\end{teorema}
Este teorema nos dice que, si $a$ es un punto ordinario, podemos declarar una solución candidata de la forma
$$y(x)= \sum_{n=0}^{\infty} c_n (x-a)^n.$$
Y por lo tanto, si logramos despejar de alguna forma los coeficientes $c_n$, tendremos nuestra solución en forma de serie.

\begin{ejemplo}
    Resuelva la ecuación $$y'' + xy= 0.$$
Note que ninguno de nuestros métodos estudiados hasta el momento funciona para resolver esta ecuación. Procederemos por series de potencias: puesto que no hay puntos singulares, podemos escoger cualquier punto (escogeremos $0$ por ser el más cómodo) como centro de nuestra serie de potencias, y ésta misma va a converger en todo $\mathbb{R}$ por el teorema anterior. Suponemos entonces que nuestra solución tiene la forma de una serie centrada en $0$
$$y = \sum_{n=0}^\infty c_nx^n = c_0 + c_1x + c_2x^2 + \dots.$$
La idea de éste método es la siguiente: como estamos asumiendo que $y$ es solución, al derivarla y sustituirla en la ecuación diferencial, tendremos suficiente información para despejar los coeficientes $c_n$.
$$2c_2 + \sum_{n=1}^\infty [c_{n+2}(n+2)(n+1) + c_{n-1}]x^n = 0.$$
A partir de aquí, debemos comparar coeficientes a cada lado de la igualdad, para encontrar los valores de $c_n$.
$$\begin{cases}
c_2 = 0 \\
c_{n+2}(n+2)(n+1) + c_{n-1} = 0 , \text{ para todo } n \geq 1.
\end{cases}$$
A partir de aquí, para despejar las demás $c_n$'s, debemos utilizar una \textbf{relación de recurrencia}: Note que $c_{n+2}$ puede encontrase a partir de $c_{n-1}$, de la forma
$$c_{n+2} = \frac{-c_{n-1}}{(n+2)(n+1)}$$
La solución general a la ecuación $y'' + xy =0$ es entonces
$$y = c_0y_0(x) + c_1y_1(x)$$
donde
\begin{align*}
y_0(x) &=  \sum_{n=0} ^\infty \frac{4 \cdot 7 \cdot 10\cdots (3n-2) }{(3n)!} (-1)^n  x^{3n} \\
y_1(x) &= \sum_{n=0}^\infty \frac{2 \cdot 5 \cdot 8\cdots (3n-1) }{(3n+1)!} (-1)^n  x^{3n+1}
\end{align*}
En general es difícil pasar de la expresión en serie a una expresión elemental (trigonométrica, exponencial, logaritmo, etc). De hecho, la mayoría de soluciones analíticas no tienen expresión elemental.
\end{ejemplo}

\begin{ejemplo}
    Resuelva la ecuación 
$$y'' + (\cos x)y = 0.$$
Una vez más, tomamos $y = \sum_{n=0}^\infty c_nx^n$. 
Centraremos alrededor de 0 por comodidad, pues no hay puntos singulares. Tenemos entonces que usar la serie de Taylor para $\cos(x)$, que es analítica.
\begin{alignat*}{2}
&& y'' + (\cos x)y &= \sum_{n=2}n(n-1)c_nx^{n-2} + \left(1-\frac{x^2}{2!} + \frac{x^4}{4!} - \dots \right)\sum_{n=0}^\infty c_nx^n = 0\\
\Rightarrow&&  &=2c_2 + 6c_3x + 12c_4x^2 + \dots +  \left(1-\frac{x^2}{2!} + \dots \right) (c_0 + c_1x  + \dots) = 0
\end{alignat*}
Entonces, comparando coeficientes, obtenemos el sistema de ecuaciones
$$\begin{cases}
2c_2 + c_0 = 0 \\
6c_3 + c_1 = 0 \\
12c_4 + c_2 - \frac{1}{2}c_0 = 0 \\
20c_5 + c_3 - \frac{1}{2}c_1 = 0
\end{cases}$$
cuya solución es $c_2 = -c_0/2$ , $c_3 = -c_1/6$ , $c_4 = c_0/12$, y $c_5 = c_1/30$. Al agrupar los términos de la serie, obtenemos finalmente que la solución general (hasta donde la pudimos calcular), es
$$y= c_0y_0(x) + c_1y_1(x)$$
donde
$$y_0(x) = 1-\frac{1}{2}x^2 + \frac{1}{12}x^4 + \dots \ \text{ y } \ y_2(x)=x- \frac{1}{6}x^3 + \frac{1}{30}x^5 + \dots$$
\end{ejemplo}

\section{Solución en un vecindario de un punto singular regular}
También podemos resolver ecuaciones diferenciales de la forma \eqref{eqn:13} centrando nuestra serie alrededor de un punto singular, pero debemos tener ciertas precauciones.

\begin{definicion}{Punto Singular Regular}{}
    Sea $x_0$ un punto singular de la ecuación $y''+ P(x)y' + Q(x)y = 0$, Decimos que $x_0$ es un \textbf{punto singular regular} si las funciones
$$p(x) = (x-x_0)P(x) \ , \ q(x) = (x-x_0)^2Q(x)$$
son ambas analíticas en $x_0$. Los puntos singulares que no son regulares, los llamaremos puntos \textbf{irregulares.}
\end{definicion}

\begin{teorema}{Método de Frobenius}{}
    Si $x=x_0$ es un punto singular regular de la ecuación diferencial 
$$y''+P(x)y' + Q(x)y =0,$$ entonces existe al menos una solución de la forma
$$y=\sum_{n=0}^{\infty} c_n(x-x_0)^{n+r}.$$
La serie convergerá en algún intervalo $(x_0-R,x_0+R)$, con $R>0$. Para encontrar $r$, debemos resolver la \textbf{ecuación indicial}, dada por
$$r(r-1) + p_0r + q_0 = 0$$
donde
$$p_0 = \lim_{x \to x_0} (x-x_0)p(x) \quad \text{y} \quad q_0 = \lim_{x \to x_0} (x-x_0)^2q(x).$$
Dependiendo de las dos soluciones de la ecuación indicial, las soluciones se construyen de distintas formas:
\begin{itemize}
\item \textbf{Caso 1:} Cuando $r_1-r_2 \notin \mathbb{Z}$, tenemos dos soluciones l.i de la forma
$$y_1(x) = \sum_{n=0}^\infty c_n x^{n+r_1} \quad \text{y} \quad y_2(x) = \sum_{n=0}^\infty b_n x^{n+r_2} $$
\item \textbf{Caso 2:} Si $r_1-r_2 \in \mathbb{Z}$, las soluciones son 
$$y_1(x) = \sum_{n=0}^\infty c_n x^{n+r_1} \quad \text{y} \quad y_2(x) = Ay_1(x)\ln(x) + \sum_{n=0}^\infty b_n x^{n+r_2} $$
donde $A$ es una constante a determinar (la cual podría ser incluso $0$). En el caso especial cuando $r_1=r_2$, tenemos que $A=1$.
\end{itemize}
\end{teorema}

\begin{ejemplo}
    Para la ecuación
    $$(x^2 -4)^2y'' + 3(x-2)y' + 5y = 0$$
    es evidente que $x_0=2$ y $x_1=-2$ son ambos puntos singulares. Sin embargo, note que, estudiando primero $x_0=2$,
    \begin{align*}
        p(x) & = (x-2)P(x) = \frac{3(x-2)^2}{(x^2-4)^2} = \frac{3}{(x+2)^2}   \\
        q(x) & = (x-2)^2Q(x) = \frac{5(x-2)^2}{(x^2-4)^2}= \frac{5}{(x+2)^2}.
    \end{align*}
    Como ambas funciones $p(x),q(x)$ son analíticas en $x=2$, concluimos que $2$ es un punto singular regular. Veamos qué pasa con $-2$,
    \begin{align*}
        p(x) & = (x+2)P(x) = \frac{3(x+2)(x-2)}{(x^2-4)^2} = \frac{3}{(x+2)(x-2)}.
    \end{align*}
    Esta función no es analítica en $x=-2$, por lo que el punto $-2$ es singular irregular (no necesitamos revisar $q(x)$).
\end{ejemplo}

\begin{ejemplo}
    Resuelva la ODE siguiente
    $$3xy'' + y' - y = 0.$$
    Primero, reescribimos:
    $$y'' + \frac{y'}{3x} - \frac{y}{3x} = 0,$$
    de donde podemos observar de inmediato que $x_0 = 0$ es un punto singular regular, en efecto:
    \begin{align*}
        p(x) = \frac{x}{3x}    & = \frac{1}{3}   \\
        q(x) = -\frac{x^2}{3x} & =  -\frac{x}{3}
    \end{align*}
    ambas funciones analíticas en $0$ (y en todo $\mathbb{R}$). Entonces procedemos a resolver la ecuación indicial. Como
    $$p_0=\lim_{x \to 0} p(x) = \frac{1}{3} \quad \text{y} \quad q_0 = \lim_{x \to 0} q(x) = 0,$$
    debemos resolver la ecuación
    $$r(r-1) + \frac{r}{3} = 0.$$
    Las raíces de esta ecuación son $r_1= 0$ y $r_2= 2/3$, por lo que debemos proceder como en el caso 1. Proponemos dos soluciones de la forma
    $$y_1(x) = \sum_{n=0}^\infty c_n x^n \quad \text{y} \quad y_2(x) = \sum_{n=0}^\infty b_n x^{n+2/3}.$$
    Derivando $y_1$ y sustituyendo en la ecuación, obtenemos la recurrencia
    $$c_0 = c_1 \ \text{ y } \ c_{n+1} = \frac{c_n}{(n+1)(3n+1)}$$
    por lo que, en general, para todo $n \geq 1$,
    $$c_n = \frac{c_0}{(n!) \cdot 1 \cdot 4 \cdot 7 \cdot (3n-2)}$$
    y entonces
    $$y_1(x) = \left(1+ \sum_{n=1}^\infty \frac{x^n}{(n!)\cdot 1 \cdot 4 \cdot 7 \cdots (3n-2)} \right).$$

    Para $y_2$, obtenemos la recurrencia
    $$b_{n} = \frac{b_{n-1}}{n(3n+2)} \ \text{ para $n \geq 1$}.$$
    la cual da
    $$b_n = \frac{b_0}{(n!)\cdot 5 \cdot 8 \cdot 11 \cdots (3n+2)} \text{ para $n \geq 1$}$$
    de donde obtenemos
    $$y_2(x) = x^{2/3} \left(1+ \sum_{n=1} ^\infty \frac{x^n}{(n!)\cdot 5 \cdot 8 \cdot 11 \cdots (3n+2)}  \right).$$
    La solución general es $y(x) = Ay_1(x) + By_2(x)$.
\end{ejemplo}

\begin{ejemplo}
    Considere la ecuación
    $$x(x-1)y'' + 3xy' + y = 0$$
    El punto $x_0 = 0$ es singular regular (ejercicio: verificar). La ecuación indicial es $r(r-1)=0$, con raíces $r_1=0$, $r_2=1$. Como estamos en el caso 2, tomamos $y_1(x) = \sum_{n=0}^\infty c_nx^n$. Sustituyendo se obtiene la recurrencia $c_0= 0$ y $c_{n+1} = c_n \frac{n+1}{n}$, de donde $c_n= nc_1$, lo cual nos da
    $$y_1(x) = \sum_{n=1}^\infty n x^n = \frac{x}{(1-x)^2}.$$

    Para $y_2$, podemos usar la fórmula de Abel:
    $$y_2(x) = y_1(x) \int \frac{\exp(-\int \frac{3dx}{x-1})}{y_1^2(x)}dx = -\frac{1+x \ln x}{(1-x)^2}.$$
    La solución general es
    $$y = C_1\frac{x}{(1-x)^2} + C_2 \frac{1+x\ln(x)}{(1-x)^2}.$$
\end{ejemplo}

\begin{ejercicios}
    \begin{enumerate}
        \item Encuentre la solución general de $y' = 3y$ usando un desarrollo en serie de potencias centrado en $x=0$.
        \item Encuentre las dos soluciones fundamentales de la ecuación de \textit{Airy} $y'' = xy$.
        \item Encuentre la solución general de $(x^2+1)y'' + xy' - y = 0$.
        \item Demuestre que la función $$J_0(t) = \sum_{m=0}^\infty \frac{(-1)^m}{(m!)^2}\left( \frac{t}{2}\right)^m$$
              es solución de la ecuación $t^2x''(t) + tx'(t) + t^2x(t) =0$. Esta función se conoce como \textit{función de Bessel de orden } 0.
              
              \begin{figure}[H]
                  \centering
                  \includegraphics[width=0.8\textwidth]{Recorte8.png}
                  \caption{Funciones de Bessel $J_0(t)$ y $J_1(t)$.}
                  \label{fig:bessel}
              \end{figure}
        \item Demuestre utilizando series de potencias, que la solución general de $y'' + y =0$ viene dada por $y = A\cos(x) + B\sen(x)$.
        \item Encuentre los primeros $5$ términos del desarrollo en series de potencias de cada solución fundamental de la ecuación
              $y'' + \sen(x) + e^x y = 0$.
        \item Encuentre una solución fundamental de la ecuación $x^2 y'' - xy' + (1-x)y = 0$. Exprésela como serie de potencias alrededor del punto $x=0$.
    \end{enumerate}
\end{ejercicios}
